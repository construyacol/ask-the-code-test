{"version":3,"sources":["components/forms/widgets/sharedStyles.js","components/forms/widgets/biometricKycComponent/index.js","components/forms/hooks/useStage.js","components/forms/widgets/biometricKycComponent/utils.js","components/forms/widgets/biometricKycComponent/biometricStatus.js","components/forms/widgets/biometricKycComponent/scanner.js","components/forms/hooks/useInputValidations.js","components/forms/widgets lazy /^/.//.*//validations$/ groupOptions: {} namespace object","components/hooks/useSocket.js"],"names":["showButton","keyframes","Button","styled","button","showWelcome","hideWelcome","hideStage","showStage","flipInVerRight","tiltInFwdTl","Container","div","props","rowGap","Layout","ContentContainer","Content","section","modelsPath","ENVIRONMENT_VAR","getCdnPath","DynamicLoadComponent","loadable","BiometricKycComponent","handleDataForm","handleState","modelData","useSelector","state","dataForm","pathName","wrapperComponent","setState","loading","setLoading","useState","cameraAvailable","setCameraAvailable","boardingAgreement","setBoardingAgreement","coinsendaServices","useCoinsendaServices","validations","useValidations","videoEl","useRef","intervalDetection","faceApi","window","faceapi","faceApiCanvas","biometricData","useSocket","authData","userId","stageManager","useStage","Object","keys","handleError","errors","stages","stageData","currentStage","nextStage","finalStage","setStageData","setupFaceApi","async","alert","current","nets","tinyFaceDetector","loadFromUri","faceLandmark68Net","faceRecognitionNet","faceExpressionNet","startStreaming","handleVideo","stream","srcObject","videoError","err","console","log","navigator","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","oGetUserMedia","video","addEventListener","canvas","createCanvasFromMedia","style","display","id","document","querySelector","append","matchDimensions","getDisplaySize","challengeIsSolved","prevState","solved","setTimeout","initDetections","intervalTime","scanner","sessionStorage","removeItem","key","setInterval","detections","detectAllFaces","TinyFaceDetectorOptions","withFaceLandmarks","withFaceDescriptors","withFaceExpressions","length","classList","value","includes","add","_value","getItem","clearInterval","setItem","biometricId","res","addNewBiometricData","file","split","biometric_id","challenge_name","data","remove","useEffect","funcDebounces","keyId","storageType","timeExect","callback","disableTransactionSecutiry","orderData","order","paymentProof","confirmDepositOrder","loadDynamicScript","pause","getTracks","stop","component","className","handleAction","ContentContainers","VideoContainer","autoPlay","ref","width","height","IndicatorStage","Indicator","uiName","device","laptopM","stageController","defaultStage","stageStatus","setStageStatus","setCurrentStage","step","prevStage","settings","queryParams","query","getQuery","history","push","nextStageData","clientWidth","clientHeight","getFrame","getContext","drawImage","toDataURL","approve","StatusContainer","StatusIndicator","status","setStatus","size","color","scanning","Scanner","setValidations","vals","error","default","getValidations","map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","t","module","exports","channel","SocketUrl","Environtment","socket","io","socketData","setSocketData","startConnect","userToken","getToken","body","access_token","emit","on"],"mappings":"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","file":"static/js/12.6d34429b.chunk.js","sourcesContent":["import styled, { keyframes } from \"styled-components\";\n\n\n\nexport const showButton = keyframes`\n    0% {\n      filter: grayscale(1) blur(1px);\n        opacity:.1;\n    }\n    20% {\n      filter: grayscale(1) blur(0px);\n      opacity:.1;\n    }\n    90% {\n      filter: grayscale(1) blur(0px);\n      opacity:.1;\n    }\n   \n    100%{\n      filter: grayscale(0) blur(0px);\n        opacity:1;\n    }\n`;\n\nexport const Button = styled.button`\n  background: #0198ff;\n  font-size: 17px;\n  font-weight: bold;\n  width:270px;\n  height:60px;\n  border-radius:5px;\n  border: none;\n  color: white;\n  cursor:pointer;\n  position:absolute;\n  bottom:40px;\n  opacity:.1;\n  filter: grayscale(1) blur(1px);\n\n  &.showButton{\n    animation: ${showButton} .8s linear forwards;\n  }\n\n`\n\nexport const showWelcome = keyframes`\n    0% {\n        transform: translateY(50px);\n        filter:blur(5px);\n        opacity:0;\n    }\n    50% {\n        transform: translateY(50px);\n        filter:blur(1px);\n        opacity:0;\n    }\n    100%{\n        transform: translateY(0px);\n        filter:blur(0px);\n        opacity:1;\n    }\n`;\n\nexport const hideWelcome = keyframes`\n    0% {\n        transform: translateY(0px);\n        filter:blur(0px) grayscale(0.2);\n        opacity:1;\n        \n    }\n    60% {\n        transform: translateY(5px);\n        filter:blur(3px) grayscale(1);\n        opacity:1;\n    }\n    100%{\n        transform: translateY(-70px);\n        filter:blur(5px) grayscale(1);\n        opacity:0;\n    }\n`;\n\nexport const hideStage = keyframes`\n    0% {\n        transform: translateY(0px);\n        filter:blur(0px) grayscale(0.2);\n        opacity:1;\n        \n    }\n    100%{\n        transform: translateY(-15px);\n        filter:blur(1px);\n        opacity:0;\n    }\n`;\n\n\nexport const showStage = keyframes`\n    0% {\n        transform: translateY(10px);\n        filter:blur(1px);\n        opacity:0;\n    }\n    100%{\n        transform: translateY(0px);\n        filter:blur(0px);\n        opacity:1;\n    }\n`;\n\n\n\nexport const flipInVerRight = keyframes`\n  0% {\n    transform: rotateY(80deg);\n    opacity: 0;\n  }\n  100% {\n    transform: rotateY(0);\n    opacity: 1;\n  }\n`;\n\nexport const tiltInFwdTl = keyframes`\n    0% {\n            transform: rotateY(-65deg) rotateX(35deg) translate(-60px, -60px) skew(45deg, -20deg);\n    opacity: 0;\n  }\n  50%{\n    opacity: 1;\n  }\n  100% {\n            transform: rotateY(0) rotateX(0deg) translate(0, 0) skew(0deg, 0deg);\n    opacity: 1;\n  }\n`;\n\n\nexport const Container = styled.div`\n    &.show_{\n        animation: ${showWelcome} .5s linear forwards;\n    }\n    &.hide_{\n        animation: ${hideWelcome} .5s linear forwards;\n    }\n\n    row-gap: ${props => props.rowGap ? `${props.rowGap}px` : 0};\n\n    perspective: 500px;\n    perspective-origin: calc(50% + 120px) 50%;\n\n    .flip-in-ver-right {\n        animation: ${tiltInFwdTl} 0.6s .25s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n    \n    }\n    display: grid;\n    align-items: center;\n    justify-items: center;\n    transform: translateY(50px);\n    opacity:0;\n\n    h1, h2{\n        color: var(--paragraph_color);\n        font-size: 30px;\n        margin: 0;\n        font-weight:300;\n    }\n    span{\n        font-size:45px;\n    }\n`\n\n\nexport const Layout = styled.div`\n    display: grid;\n    width: 100vw;\n    height: 100vh;\n    background: #ffffffff;\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index:1000;\n  @media screen and (max-height: 900px){\n  }\n`\n\nexport const ContentContainer = styled.div`\n  position:relative;\n  width:100vw;\n  height:auto;\n  max-width:800px;\n  display: grid;\n  grid-template-columns: 1fr;\n  grid-template-rows: auto 1fr auto auto auto;\n  height: calc(100vh - 80px);\n  padding: 40px 0;\n`\n\nexport const Content = styled.section`\n  width:100vw;\n  height:100vh;\n  display:grid;\n  position:relative;\n  align-items:center;\n  justify-items:center;\n  \n  [alt=\"isoType\"]{\n    position: absolute;\n    margin: auto;\n    top: 30px;\n    left: 40px;\n    left: 0px;\n    right:0;\n  }\n`","import { useEffect, useRef, useState } from 'react'\nimport useStage from '../../hooks/useStage'\nimport useValidations from '../../hooks/useInputValidations'\nimport { getDisplaySize } from './utils'\nimport loadable from '@loadable/component'\nimport styled from 'styled-components'\nimport StatusIndicator from './biometricStatus'\nimport { Scanner } from './scanner'\n// import Captures from './captures'\nimport { getCdnPath } from '../../../../environment'\nimport loadDynamicScript from '../../../../utils/loadDynamicScript'\nimport { useCoinsendaServices } from \"../../../../services/useCoinsendaServices\";\nimport useSocket from '../../../hooks/useSocket'\nimport { useSelector } from \"react-redux\";\nimport { ENVIRONMENT_VAR, device } from '../../../../const/const'\nimport { funcDebounces } from '../../../../utils'\n\nimport { \n  Layout,\n  ContentContainer\n} from '../sharedStyles'\n\n\nconst modelsPath = ENVIRONMENT_VAR === 'development' ? '/models' : `${getCdnPath('tensor')}/`\nconst DynamicLoadComponent = loadable(() => import('../../dynamicLoadComponent'))\nconst BiometricKycComponent = ({ handleDataForm, handleState, ...props }) => {\n\n  const modelData = useSelector((state) => state.modelData);\n  const { dataForm } = handleDataForm\n  const pathName = dataForm?.wrapperComponent\n  const { state, setState } = handleState\n  const [ loading, setLoading ] = useState(false)\n  const [ cameraAvailable, setCameraAvailable ] = useState()\n  const [ boardingAgreement, setBoardingAgreement ] = useState(false)\n  const [ coinsendaServices ] = useCoinsendaServices();\n  const validations = useValidations(pathName)\n\n  const videoEl = useRef(null);\n  let intervalDetection = useRef(null);\n  const faceApi = useRef(window.faceapi)\n  let faceApiCanvas = useRef(null);\n  \n  // const [ developerMood ] = useState(window?.location?.search?.includes('developer=true'))\n  const [ biometricData ] = useSocket(`/biometric_data/${modelData.authData.userId}`)\n\n  const stageManager = useStage(\n    // create the form stages\n    Object.keys(dataForm?.handleError?.errors || dataForm.stages),\n    dataForm.stages\n  )\n\n  const {\n    stageData,\n    currentStage,\n    nextStage,\n    finalStage,\n    setStageData,\n    // stageController\n  } = stageManager\n\n  // const finalStage = true\n\n  const setupFaceApi = async() => {\n    setLoading(true)\n    if(!window.faceapi) return alert('No están cargando las librerías FACE_API');\n    faceApi.current = window.faceapi\n    await faceApi.current.nets.tinyFaceDetector.loadFromUri(modelsPath)\n    await faceApi.current.nets.faceLandmark68Net.loadFromUri(modelsPath)\n    await faceApi.current.nets.faceRecognitionNet.loadFromUri(modelsPath)\n    await faceApi.current.nets.faceExpressionNet.loadFromUri(modelsPath)\n    startStreaming()\n  } \n\n  const handleVideo = stream => {\n    setCameraAvailable(true)\n    if(!videoEl.current) return;\n    videoEl.current.srcObject = stream;\n  }\n\n  const videoError = err => {\n    console.log('No hay camara conectada o los permisos han sido denegados', err) \n    setCameraAvailable(false)\n  } \n\n\n  const startStreaming = () => {\n    navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || navigator.oGetUserMedia;\n    if (navigator.getUserMedia) {     \n      navigator.getUserMedia({video: true}, handleVideo, videoError);\n      if(!videoEl.current?.addEventListener) return;\n      videoEl.current.addEventListener('play', () => {\n        console.log('el streaming a comenzado', faceApi.current)\n        const canvas = faceApi.current.createCanvasFromMedia(videoEl.current)\n        canvas.style.display = 'none'\n        canvas.id = \"faceApiCanvas\"\n        document.querySelector('#videoContainer').append(canvas)\n        faceApiCanvas.current = canvas\n        faceApi.current.matchDimensions(canvas, getDisplaySize())\n        setLoading(false)\n      })\n    }\n  }\n\n  // const startDeveloperMood = (canvas, detections) => {\n  //   canvas.style.display = 'initial'\n  //   const resizedDetections = faceApi.current.resizeResults(detections, getDisplaySize())\n  //   canvas.getContext('2d').clearRect(0, 0, canvas.width, canvas.height)\n  //   faceApi.current.draw.drawFaceLandmarks(canvas, resizedDetections)\n  //   faceApi.current.draw.drawDetections(canvas, resizedDetections)\n  //   faceApi.current.draw.drawFaceExpressions(canvas, resizedDetections)\n  // }\n\n  const challengeIsSolved = () => {\n    setStageData(prevState => { return {...prevState, solved:true} })\n    setTimeout(()=> nextStage(), 1000)\n  }\n\n  // const tryToSolveChallenge = async() => {\n  //     const userBiometric = await coinsendaServices.getUserBiometric()\n  //     if(!userBiometric?.solved) return;\n  //     nextStage(stageController.length+1)\n  //     // await coinsendaServices.fetchCompleteUserData()\n  // }\n\n \n  const initDetections = (canvas, intervalTime) => {\n    const scanner = document.querySelector('.FRecScanner')\n    // let counter = 1\n    sessionStorage.removeItem(stageData?.key);\n\n    intervalDetection.current = setInterval(async() =>{\n\n      const detections = await faceApi.current.detectAllFaces(videoEl.current, \n        new faceApi.current.TinyFaceDetectorOptions())\n        .withFaceLandmarks()\n        .withFaceDescriptors()\n        .withFaceExpressions(); \n\n        // if(developerMood) startDeveloperMood(canvas, detections);\n        if(detections?.length){\n\n          if(scanner && !scanner?.classList?.value?.includes('scanning')) scanner.classList.add('scanning');\n          if(!validations[stageData?.key]){return}\n\n          const [ _value ] = validations[stageData.key](detections[0], {...stageData, state, dataForm});\n          console.log('ON detecions: ', _value)\n\n          if(!_value || sessionStorage.getItem(stageData?.key)){return}\n          // if(!_value || counter > 1){return}\n          canvas.style.display = 'none'\n          setState(prevState => {\n            return { ...prevState, [stageData?.key]: _value ? _value : prevState[stageData?.key] }\n          })\n          clearInterval(intervalDetection.current)\n          sessionStorage.setItem(stageData?.key, stageData?.biometricId);\n\n          // counter++\n          const res = await coinsendaServices.addNewBiometricData({\n            file:_value.split(',')[1],\n            biometric_id:stageData.biometricId,\n            challenge_name:stageData.key\n          })\n          console.log('addNewBiometricData', res)\n          if(res?.data === false){\n            challengeIsSolved()\n          }\n        }else{\n          console.log('Detectando...', faceApiCanvas.current)\n          if(scanner && scanner?.classList?.value.includes('scanning'))scanner.classList.remove('scanning');\n        }\n    }, intervalTime)\n  }\n\n\n  useEffect(() => {\n    // const canvas = document.querySelector('#faceApiCanvas')\n    if((boardingAgreement && faceApiCanvas.current) && (!stageData?.solved && !finalStage)){\n      initDetections(faceApiCanvas.current, 600)\n    }\n    console.log('|||||||||||||||||||||||||||||||||||||||||||||||||||||||||  stageData ==> ', stageData, state)\n    return () => clearInterval(intervalDetection.current)\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [stageData, boardingAgreement, loading])\n\n  // const exectFuncDebounce = () => {\n    \n  // }\n\n  useEffect( () => {\n    // console.log('|||||||||||||  biometricData ==> ', cameraAvailable, biometricData)\n    // debugger\n    // if(biometricData?.state === 'accepted' && !cameraAvailable){\n    //   tryToSolveChallenge()\n    // }\n\n    console.log('||||||||||||| SOCKET biometricData ===> ', cameraAvailable, biometricData)\n    if(biometricData?.challenge_name === stageData?.key){\n      if(biometricData.state === 'accepted'){\n        funcDebounces({\n          keyId:{[biometricData.state]:biometricData.id}, \n          storageType:\"sessionStorage\",\n          timeExect:1500,\n          callback:() => {\n            challengeIsSolved()\n          }\n        })\n      }else if(biometricData.state === 'rejected'){\n        funcDebounces({\n          keyId:{[biometricData.state]:biometricData.id}, \n          storageType:\"sessionStorage\",\n          timeExect:1500,\n          callback:() => {\n            initDetections(faceApiCanvas.current, 600)\n          }\n        })\n      }\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [biometricData])\n\n\n  useEffect(()=>{\n    if(finalStage){\n      const disableTransactionSecutiry = async() => {\n        await coinsendaServices.disableTransactionSecutiry(\"biometric\");\n        if(!props.orderData) return;\n        const { orderData:{ order, paymentProof } } = props\n        return coinsendaServices.confirmDepositOrder(order.id, paymentProof);\n      }\n      disableTransactionSecutiry()\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [finalStage])\n\n  useEffect(()=>{\n    loadDynamicScript(setupFaceApi, `${getCdnPath('faceApi')}`, 'faceApi')\n    return () => {\n      videoEl.current?.pause();\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      videoEl.current?.srcObject?.getTracks()[0].stop()\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  // console.log('||||||||||||||||||||||||||||||||||||||||  BiometricKyc PROPS', props)\n\n  \n   if(finalStage){\n    // Render success Stage\n    return (\n      <>\n        {/* { developerMood && <Captures state={state}/> } */}\n        <DynamicLoadComponent\n              component={`${dataForm?.wrapperComponent}/success`}\n              handleDataForm={handleDataForm}\n              handleState={handleState}\n              coinsendaServices={coinsendaServices}\n              {...props}\n        />\n      </>\n    )\n  }\n\n    return(\n      <Layout className=\"faceApiLayout__\">\n        { \n          !boardingAgreement &&\n            <DynamicLoadComponent\n              component=\"biometricKycComponent/onBoardingAgreement\"\n              cameraAvailable={cameraAvailable}\n              handleAction={() => {\n                setBoardingAgreement(true)\n              }}\n            /> \n        }\n\n        {/* { developerMood && <Captures state={state}/> } */}\n\n        <ContentContainers id=\"faceApiContainer\">\n          <StatusIndicator \n            data={stageData?.solved}\n          />\n          <h3 className=\"FRecTitle fuente\">Reconocimiento Facial</h3>\n          <VideoContainer id=\"videoContainer\">            \n            { loading && <div className=\"biometricLoaderContainer\"></div>}\n            {/* { !developerMood && <Scanner className=\"FRecScanner\"/>} */}\n            <Scanner className=\"FRecScanner\"/>\n            <video id=\"streamingVideo\" autoPlay={true} ref={videoEl} width={'100%'} height={'100%'} />\n          </VideoContainer>\n          <IndicatorStage>\n            <Indicator className={`${currentStage === 0 ? 'active' : ''}`}/>\n            <Indicator className={`${currentStage === 1 ? 'active' : ''}`}/>\n          </IndicatorStage>\n          <h1 className=\"fuente\">{stageData?.uiName}</h1>\n          <p className=\"fuente\">Mantén tu cabeza erguida y asegurate que tu rostro encaje dentro del circulo</p>\n        </ContentContainers>\n      </Layout>\n    )\n} \n\n\nexport default BiometricKycComponent\n\n\nconst Indicator = styled.div`\n  width:7px;\n  height:12px;\n  background:#c9c9c9;\n  border-radius:5px;\n  margin:0 4px;\n  transition:.3s;\n  &.active{\n    height:22px;\n    background:#0198ff;\n  }\n`\n\nconst IndicatorStage = styled.div`\n  height:30px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`\n \nconst VideoContainer = styled.div`\n  position: relative;\n  clip-path: circle(37% at 50% 50%);\n\n  @media ${device.laptopM} {\n    max-height: 300px;\n    clip-path: none;\n    width: fit-content;\n    justify-self: center;\n    overflow: hidden;\n    border-radius: 15px;\n  }\n`\n\nconst ContentContainers = styled(ContentContainer)`\n\n  justify-self:center;\n\n  .FRecTitle{\n    color:#0198ff;\n    font-weight:bold;\n  }\n  p{\n    text-align:center;\n    color:gray;\n    font-size: 1.2em;\n    max-width: 500px;\n    justify-self: center;\n  }\n  h1{\n    text-align:center;\n    font-size: 2.7em;\n    margin-bottom:0;\n  }\n  h3{\n    span{\n      color: transparent;\n      border-radius: 50%;\n      background: #2ad083;\n      margin-right: 10px;\n      font-size:15px;\n    }\n  }\n\n  @media ${device.laptopM} {\n    padding: 10px 0;\n    height: calc(100vh - 20px);\n  }\n\n  @media (max-width: 768px) {\n    ${VideoContainer}{\n      ${'' /* clip-path: circle(29% at 50% 50%); */}\n    }\n\n    padding: 30px 20px;\n    width:calc(100vw - 40px);\n    height: calc(100vh - 60px);\n\n    p{\n      font-size:1em;\n    }\n    h1{\n      font-size:2em;\n    }\n\n  }\n\n\n`\n\n// Pitch: 'Rotate head' \n// Rigth: +,\n// Left:-\n\n// Roll: 'Tilt head'\n// Rigth: +,\n// Left:-\n\n// Open the mouth\n// Smile\n\n// crear developer mode\n// true = no toma screenshots, muestra indicadores face expressions|detections|logs\n// false = user mood, funcionamiento para usuario final\n\n// Detectar la camara handle camera error | notFound(continous flow from mobile)\n// Agregar marca de agua\n// Copy: Desarrollado por Coinsenda\n\n// Cargar librería de forma dinámica\n// cargar modelos desde cdn \n\n// modularizar en component/utils todas las funciones de utilidad y de validación correspondientes a cada componente\n// diseñar la interfaz\n\n// tener en cuenta el factor tiempo \n// Detectar progresividad de los gestos\n// enviar 3 frames al backend\n\n\n// acceder nativamente a la camara del celular","import { useState, useEffect } from 'react'\nimport { getQuery } from '../utils'\nimport { history } from 'const/const'\n\nconst useStage = (stageController, stages, defaultStage = 0) => {\n\n  const [ stageStatus, setStageStatus ] = useState()\n  const [ currentStage, setCurrentStage ] = useState(defaultStage)\n  const [ stageData, setStageData ] = useState(stages[stageController[currentStage]])\n\n  const nextStage = (step = 1) => {\n    // add ref or className on Json file Source to management the DOM components, e.x buttons states...\n    if(currentStage >= stageController.length){return}\n      setCurrentStage(prevState => prevState+step)\n  }\n\n  const prevStage = () => {\n    if(currentStage <= 0){return}\n    setCurrentStage(prevState => prevState-1)\n  }\n\n// Set url query params\n  useEffect(()=>{\n    if(stageData?.settings?.queryParams){\n      let query = getQuery(stageData.settings.queryParams)\n      history?.push(query)\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [stageData])\n\n  useEffect(()=>{\n    const nextStageData = stages[stageController[currentStage]] \n    setStageData(nextStageData)\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [currentStage, stages[stageController[currentStage]]])\n\n  return {\n    currentStage,\n    nextStage,\n    prevStage,\n    stageController,\n    stageData,\n    setStageData,\n    stageStatus,\n    setStageStatus,\n    finalStage:currentStage >= stageController.length\n  }\n\n}\n\nexport default useStage\n","\nexport const getDisplaySize = () => {\n  const video = document.querySelector(\"#streamingVideo\")\n  return { width: video.clientWidth, height: video.clientHeight }\n}\n\n\nexport const getFrame = () => {\n  const { width, height } = getDisplaySize()\n  const canvas = document.querySelector(\"#faceApiCanvas\")\n  canvas.width = width\n  canvas.height = height\n  const video = document.querySelector(\"#streamingVideo\")\n  const ctx = canvas.getContext('2d')\n  ctx.drawImage(video, 0,0, width, height)\n  let dataURL = canvas.toDataURL('image/jpeg')\n  return dataURL\n}","import { useState, useEffect } from \"react\";\nimport styled, { keyframes } from 'styled-components'\nimport { AiOutlineScan } from 'react-icons/ai';\nimport { BsCheck } from 'react-icons/bs';\nimport { device } from '../../../../const/const'\n\n\nconst StatusIndicator = ({ data }) => {\n\n    const [ status, setStatus ] = useState()\n  \n    useEffect(()=>{\n        // console.log('_______ ====================== StatusIndicator ==>', data)\n        if(data){\n          setStatus('approve')\n        }else{\n          setTimeout(()=>setStatus(), 400)\n        }\n    }, [data])\n    \n    return(\n      <StatusContainer className={`${status === 'approve' ? 'approve' : 'normal'}`}>\n        { !status ?\n          <AiOutlineScan size={30} color=\"#a3a3a3\"/>\n          :\n          <BsCheck size={37} color=\"white\" />\n        }\n      </StatusContainer>\n    )\n  \n  }\n\n\n  const approve = keyframes`\n    0% {\n        opacity: 1;\n        transform: scale(1);\n    }\n    30% {\n        transform: scale(0);\n        opacity: 0;\n    }\n    50%{\n        transform: scale(0);\n        opacity: 0;\n    }\n    80%{\n        opacity: 1;\n        transform: scale(1.3);\n    }\n    100%{\n        opacity: 1;\n        transform: scale(0.9);\n        background:#2ad083;\n        border: 4px solid white;\n    }\n    `;\n  \n  const StatusContainer = styled.div`\n    width: 60px;\n    height: 60px;\n    position: absolute;\n    border-radius: 50%;\n    background: white;\n    border: 2px solid #cfcfcf;\n    top:175px;\n    right:200px;\n    z-index: 1;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    &.approve{\n        animation: ${approve} .6s linear forwards;\n    }\n\n    @media ${device.laptopM} {\n      top: 40px;\n      right: 180px;\n    }\n\n    @media (max-width: 768px) {\n      top: 100px;\n      right: 0;\n    }\n  `\n\n\n  \n  export default StatusIndicator","import styled, { keyframes } from 'styled-components'\n\n\nconst scanning = keyframes`\n    0% {\n        top:0%\n    }\n    15%{\n        top:30%\n    }\n    35%{\n        top:70%\n    }\n    50%{\n        top:100%\n    }\n    65%{\n        top:70%\n    }\n    85%{\n        top:30%\n    }\n    100%{\n        top:0%;\n    }\n`;\n\n\nexport const Scanner = styled.div`\n    height: 3px;\n    width: 100%;\n    position: absolute;\n    top: 0%;\n    transition: .3s;\n    filter: blur(0.1em);\n    background: rgb(255 255 255 / 10%);;\n    animation: ${scanning} 1.2s linear infinite;\n    &.scanning{\n    background: #2ad083;\n    }\n`","import { useState, useEffect } from 'react'\n// import * as biometricValidations from '../widgets/biometricKycComponent/validations';\n\nconst useValidations = (pathName) => {\n\n  const [ validations, setValidations ] = useState()\n  \n  const getValidations = async() => {\n    let vals = {}\n    try {\n      vals = await import(`../widgets/${pathName}/validations`);\n    } catch (error) {\n      console.log(error)\n    }\n    setValidations(vals?.default)\n  }\n\n  useEffect(() => {\n    getValidations()\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  return validations\n\n}\n\nexport default useValidations\n","var map = {\n\t\"./biometricKycComponent/validations\": [\n\t\t570,\n\t\t9,\n\t\t140\n\t],\n\t\"./kyc/validations\": [\n\t\t540,\n\t\t9,\n\t\t28\n\t],\n\t\"./onBoardingComponent/validations\": [\n\t\t588,\n\t\t7,\n\t\t29\n\t],\n\t\"./personalKycComponent/validations\": [\n\t\t568,\n\t\t9,\n\t\t30\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[2]).then(function() {\n\t\treturn __webpack_require__.t(id, ids[1])\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 683;\nmodule.exports = webpackAsyncContext;","import { useEffect, useState } from \"react\";\nimport io from \"socket.io-client\";\nimport Environtment from \"../../environment\";\n// import { useSelector } from \"react-redux\";\nimport { getToken } from '../utils'\n\n\nexport default function useSocket (channel, callback) {\n\n    const { SocketUrl } = Environtment;\n    const socket = io(SocketUrl);\n    const [ socketData, setSocketData ] = useState()\n    \n    const startConnect = async() => {\n        const { userToken } = await getToken()\n        const body = { body: { access_token: userToken } };\n        socket.emit(\"authentication\", body);\n    }\n\n    useEffect(()=>{\n        socket.on(\"connect\", startConnect)\n        socket.on(\"authenticated\", () => {\n            socket.on(channel, (data) => {\n                setSocketData(prevState => {\n                    return { ...prevState, ...data}\n                })\n            });\n        })\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [])\n\n    return [ socketData ]\n\n}\n\n"],"sourceRoot":""}