(this["webpackJsonpcoinsenda-app"]=this["webpackJsonpcoinsenda-app"]||[]).push([[48],{646:function(e,t,s){},647:function(e,t,s){},677:function(e,t,s){"use strict";s.r(t);var a=s(2),i=s(344),c=s.n(i),n=s(339),r=s(14);var o=e=>Object(r.jsx)(n.e,{...e}),l=s(54),d=s(98),p=s(27),h=s(99),m=s(11),u=s(15);const{CountryUrl:b}=u.a;class j extends a.Component{constructor(){super(...arguments),this.itemSelection=()=>{const{item:e}=this.props;this.props.select_item(e)}}render(){const{item:e,active:t,suffixText:s}=this.props,{name:a,flag:i}=e;return Object(r.jsx)("div",{className:"ItemListKycBasic ".concat(t?"active":""),onClick:this.itemSelection,children:Object(r.jsxs)("p",{className:"fuente",children:[i&&Object(r.jsx)("img",{src:"".concat(b).concat(i),alt:"",width:30}),a,s&&" | ( ".concat(s," )")]})})}}var _=j,y=s(348),f=s(498);const g=l.d.kyc_basic.natural;class v extends a.Component{constructor(){super(...arguments),this.state={select_values:{}},this.init_component=async()=>{await this.props.action.CurrentForm("kyc_basic");const{form_kyc_basic_state:e}=this.props;let t=await this.props.coinsendaServices.getVerificationState();if(!t||"rejected"===t||"pending"===t){this.props.action.isAppLoading(!0);const{user:t}=this.props;let s=await this.props.coinsendaServices.countryValidators(),a=await Object(m.serveKycData)(s.res.levels.level_1.personal[t.person_type]),i=await Object(m.converToInitState)(s.res.levels.level_1.personal[t.person_type]),c=await this.props.coinsendaServices.getCountryList(),n=await Object(m.extractSelectList)(a,s.res.levels.level_1.personal[t.person_type]);n.country=await Object(m.FormatCountryList)(n.country,c),n.countries=c,await this.setState({kyc_data_basic:a,select_list:n});let r=await this.matchList({value:"colombia",name:"country_prefix"}),o={...i,country_prefix:"",...e.data_state};o.country_prefix||(o.country_prefix=r),o.country||(o.country=r);let l=a[0];await this.setState({data_state:o,message:l.message,active:!1,colorMessage:"#50667a",ui_type:l.ui_type,open_sect:!1,show_hide_section:!1,current_item:l.name}),this.props.action.isAppLoading(!1)}},this.update=async e=>{let{target:t}=e;t.preventDefault&&t.preventDefault(),t.persist&&t.persist();const{name:s,value:a}=t,{ui_type:i}=this.state;if((s!==g.name.name&&s!==g.surname.name||!a||/(^[\xf1\xd1\xe1\xc1\xe9\xc9\xed\xcd\xf3\xd3\xfa\xdaA]?|^\b)(?!.*?\s{2})[\xf1\xd1\xe1\xc1\xe9\xc9\xed\xcd\xf3\xd3\xfa\xdaA-Za-z ]{1,25}(\s?)$/g.test(a))&&(s!==g.phone.name||!a||/^[0-9]{1,14}$/g.test(a))&&!(s===g.address.name&&a&&a.length>150)&&!(s===g.city&&a&&a.length>100)){if(s===g.id_number.name){if("pasaporte"===this.state.data_state.id_type[0].code){if(a&&!/^[a-zA-Z0-9]{1,20}$/g.test(a))return}else if(a&&!/^[0-9]{1,12}$/g.test(a))return}if("country_prefix"===s||"country"===s||"select"===i){let e=await this.matchList(t);if(e)return console.log("||||||||||||||| Update Function: ",e,this.state.data_state),this.setState({data_state:{...this.state.data_state,[s]:e}}),setTimeout((()=>{this.setState({open_sect:!1})}),300)}await this.setState({data_state:{...this.state.data_state,[s]:a?Object(m.capitalizeString)(a):""}}),this.validateActive()}},this.matchList=async e=>{let{value:t,name:s}=e;t||this.setState({current_search:null});const{select_list:a}=this.state;let i=await Object(m.matchItem)(a["country_prefix"===s||"nationality"===s?"countries":s],{primary:t},"code");return!!i&&(i.length<50&&this.setState({current_search:i}),1===i.length?i:void 0)},this.validateActive=async()=>{let e=await Object(m.objectToArray)(this.state.data_state);const{step:t}=this.props;return e[t-1]?this.setState({active:!0}):this.unAvailableActive()},this.unAvailableActive=()=>this.setState({active:!1}),this.siguiente=async()=>{const{kyc_data_basic:e}=this.state;if(this.props.step<=e.length)return await this.props.action.UpdateForm("kyc_basic",this.state),await this.props.action.IncreaseStep("kyc_basic"),this.props.step>e.length?this.props.validate_personal_kyc("personal"):(this._onFocus(),this.validateActive())},this.handleSubmit=async e=>{e.preventDefault();let t=await Object(m.objectToArray)(this.state.data_state);const{step:s}=this.props,a=t[s-1],{current_item:i,data_state:n}=this.state;if(!String(a).trim())return this.setState({message:"No se permiten valores vac\xedos",colorMessage:"#ff1100"});if(i===g.birthday.name&&a){if(!c()(a,"YYYY/MM/DD").isBefore(c()().subtract(18,"years")))return this.setState({message:"El registro solo es v\xe1lido para personas mayores de edad",colorMessage:"#ff1100"})}return!("phone"===i&&!n.country_prefix)&&(a?this.siguiente():this.setState({message:this.errMessage(s),colorMessage:"#ff1100"}))},this.errMessage=e=>{const{kyc_data_basic:t}=this.state;return t[e-1].errmessage},this.receivedProps=async e=>{if(!this.state.kyc_data_basic||!this.state.kyc_data_basic[e.step-1])return!1;if(e.step>this.state.kyc_data_basic.length)return!1;let t=this.state.kyc_data_basic[e.step-1].name,s="phone"===await t?this.state.data_state.country_prefix:"country"===t?this.state.data_state[t]:null;await this.setState({message:"".concat(this.state.open_sect?"":this.state.kyc_data_basic[e.step-1].message),colorMessage:"#50667a",ui_type:this.state.kyc_data_basic[e.step-1].ui_type,current_item:t,current_search:s||null}),this.validateActive()},this.toggleSection=()=>{this.setState({message:"".concat(this.state.open_sect?this.state.kyc_data_basic[this.props.step-1].message:""),open_sect:!this.state.open_sect,show_hide_section:!this.state.show_hide_section})},this._onFocus=()=>{const{open_sect:e,ui_type:t,kyc_data_basic:s}=this.state,{step:a}=this.props,i=Array.isArray(this.state.data_state[s[a-1].name]);if("select"===t&&!i)return setTimeout((()=>{this.setState({show_hide_section:!0})}),300),this.setState({message:"".concat(e?s[a-1].message:""),open_sect:!0})},this.clean_search_result=async()=>{const{ui_type:e,data_state:t,current_item:s}=this.state;let a;"phone"===s&&(a="country_prefix"),await this.setState({data_state:{...t,[a||s]:null},current_search:null}),"select"===e&&this.setState({open_sect:!0,show_hide_section:!0})},this.select_item=async e=>{const{current_item:t}=this.state;let s={target:{name:t,value:e.code}};"phone"===t&&(s.target.name="country_prefix"),await this.update(s)}}async componentDidMount(){await this.init_component(),this.props.history.push("?form=personal_names"),document.onkeydown=e=>{13===e.keyCode&&(e.preventDefault(),this.handleSubmit(e))}}componentWillUnmount(){document.onkeydown=!1}componentDidUpdate(e,t){if(e.step===this.props.step)return;let s;if(1===this.props.step&&(s="?form=personal_names"),2===this.props.step&&(s="?form=personal_surnames"),3===this.props.step&&(s="?form=personal_birthday"),4===this.props.step&&(s="?form=personal_phone"),5===this.props.step&&(s="?form=personal_address"),6===this.props.step&&(s="?form=personal_residence_city"),7===this.props.step&&(s="?form=personal_country"),8===this.props.step&&(s="?form=personal_type_id"),9===this.props.step&&(s="?form=personal_number_id"),10===this.props.step&&(s="?form=personal_nacionality"),11===this.props.step&&(s="?form=personal_success"),this.props.history.push(s),10===this.props.step&&this.state.data_state.id_type&&("cedula_ciudadania"===this.state.data_state.id_type[0].code||"cedula_extranjeria"===this.state.data_state.id_type[0].code)){(async()=>{await this.setState({data_state:{...this.state.data_state,nationality:this.state.data_state.country}}),this.siguiente()})()}}componentWillReceiveProps(e){e.step!==this.props.step&&this.setState({open_sect:!1,show_hide_section:!1}),this.receivedProps(e)}shouldComponentUpdate(e,t){return this.props!==e||this.state!==t}render(){let{open_sect:e,data_state:t,ui_type:s,current_item:a,current_search:i,kyc_data_basic:c,show_hide_section:n}=this.state;const{step:l}=this.props;return e=e&&"text"!==s,Object(r.jsx)(r.Fragment,{children:this.props.loader||!c||!l||this.props.step>this.state.kyc_data_basic.length?Object(r.jsx)(f.a,{}):Object(r.jsxs)("div",{className:"KycLayout",children:[Object(r.jsx)("p",{className:"fuente KycTitle KycTitless",children:"Verificaci\xf3n B\xe1sica"}),Object(r.jsx)(o,{update:this.update,handleSubmit:this.handleSubmit,kyc:c,step:this.props.step,state:{...this.state,open_sect:e},toggleSection:this.toggleSection,_onFocus:this._onFocus,search_results:"phone"===s?t.country_prefix?t.country_prefix:null:"select"===s&&t[c[l-1].name]?t[c[l-1].name]:null,clean_search_result:this.clean_search_result}),Object(r.jsx)("div",{id:"expandibleKycPanel",className:"expandibleKycPanel",style:{height:e?"65vh":"0",opacity:e?"1":"0"},children:n&&Object(r.jsxs)("div",{className:"contexpandibleKycPanel ".concat(e?"openSec":""),children:[i&&i.length&&Object(r.jsx)("div",{className:"contCountryList",children:i.map((e=>Object(r.jsx)(_,{item:e,select_item:this.select_item,active:i&&1===i.length&&!0},e.id)))}),("select"===s||"phone"===s)&&!i&&Object(r.jsx)("div",{className:"contCountryList",children:this.state.select_list["phone"===a||"nationality"===a?"countries":a].map((e=>Object(r.jsx)(_,{item:e,select_item:this.select_item,suffixText:"id_type"!==this.state.current_item||"cedula_ciudadania"!==e.code&&"cedula_extranjeria"!==e.code?null:this.state.data_state.country&&this.state.data_state.country[0].code},e.id)))})]})})]})})}}var O=Object(d.b)((function(e){const{user:t}=e.modelData;return{...e.form.form_kyc_basic,current:e.form.current,form_kyc_basic_state:e.form.form_kyc_basic,user:t,loader:e.isLoading.loader}}),(function(e){return{action:Object(p.bindActionCreators)(h.a,e)}}))(Object(y.a)(v)),x=s(334);s(646);var w=e=>{const{type:t}=e;return Object(r.jsxs)("div",{className:"".concat("green"===t?"imgDashFramework":"imgDashFramework2 MarcoPolo","  "),children:[Object(r.jsx)("i",{className:"".concat("green"===t?"fas fa-check-circle green":"fas fa-times-circle reds","  IconMarco")}),Object(r.jsx)("div",{className:"top_left ".concat("green"===t?"green corner":"reds corner2")}),Object(r.jsx)("div",{className:"top_right   ".concat("green"===t?"green corner":"reds corner2")}),Object(r.jsx)("div",{className:"bottom_right  ".concat("green"===t?"green corner":"reds corner2"," ")}),Object(r.jsx)("div",{className:"bottom_left  ".concat("green"===t?"green corner":"reds corner2"," ")}),e.children,Object(r.jsx)("p",{className:"textMarc ".concat("green"===t?"green":"reds"),children:"green"===t?"":"EJEMPLO INCORRECTO"})]})},S=s(1),k=s(331);var N,L,I,A,C,D=e=>{const{step:t,front:s,back:i,selfie:c,goFileLoader:n,prevState:o,animation:l,action:d,animation2:p,id_type:h,base64:m,fileloader:u}=e,{newfront:b,newselfie:j,newback:_}=m,y=Object(k.a)(!u,"upload-pic-button",13,!0,"onkeyup",!0);return Object(r.jsx)("div",{className:"KycDashBoard",children:Object(r.jsxs)("div",{className:"imgDashContainer",children:[Object(r.jsx)("p",{className:"fuente ".concat(t>3?"topThree":""),children:1===t?"1. Frente del documento":2===t?"2. Rev\xe9s del documento":3===t||4===t?"3. Selfie con documento y texto":"\xa1Lo hiciste muy Bien!"}),Object(r.jsx)(w,{type:"green",children:Object(r.jsx)("div",{className:"imgDashContainerD ".concat(l?"imgDCAnim":""),children:Object(r.jsxs)("div",{className:"imgDashSon",children:[Object(r.jsx)("img",{className:"imgDashItem ".concat(h," ").concat(p?"frontImg":""),src:s,style:{opacity:1===o?"1":"0",zIndex:2},alt:"",width:"100%"}),Object(r.jsx)("img",{className:"imgDashItem ".concat(p?"backImg":"backInit"),src:i,style:{opacity:o>2||"pasaporte"===h?"0":"1",zIndex:1},alt:"",width:"100%"}),Object(r.jsx)("img",{className:"imgDashItem",src:c,style:{opacity:o>2?"1":"0"},alt:"",width:"100%"})]})})}),Object(r.jsxs)("div",{className:"imgDashCarousel",style:{gridTemplateColumns:"pasaporte"===h?"repeat(2, 1fr)":"repeat(3, 1fr)",maxWidth:"pasaporte"===h?"260px":"400px"},children:[Object(r.jsx)("div",{className:"imgDashStep ".concat(1===t?"active":""),title:"1",children:b?Object(r.jsxs)(a.Fragment,{children:[Object(r.jsx)("img",{className:"imgDashItem",src:b,alt:"",width:"80",title:"1"}),Object(r.jsx)("i",{className:"fas fa-check-circle"})]}):Object(r.jsx)("img",{className:"imgDashItem ".concat(h),src:s,alt:"",width:"80",title:"1"})}),"pasaporte"!==h&&Object(r.jsx)("div",{className:"imgDashStep ".concat(2===t?"active":""),title:"2",children:_?Object(r.jsxs)(a.Fragment,{children:[Object(r.jsx)("i",{className:"fas fa-check-circle"}),Object(r.jsx)("img",{className:"imgDashItem",src:_,alt:"",width:"80",title:"2"})]}):Object(r.jsx)("img",{className:"imgDashItem",src:i,alt:"",width:"80",title:"2"})}),Object(r.jsx)("div",{className:"imgDashStep ".concat(3===t||4===t?"active":""),title:"3",children:j?Object(r.jsxs)(a.Fragment,{children:[Object(r.jsx)("i",{className:"fas fa-check-circle"}),Object(r.jsx)("img",{className:"imgDashItem",src:j,alt:"",width:"80",title:"3"})]}):Object(r.jsx)("img",{className:"imgDashItem",src:c,alt:"",width:"80",title:"3"})})]}),Object(r.jsx)("div",{className:"controlContainers",children:t<4?Object(r.jsxs)("div",{className:"contButtonUpload",children:[Object(r.jsx)("input",{id:u?"":y,type:"file",accept:S.b.join(),onChange:n}),Object(r.jsxs)(x.b,{active:!0,type:"primary",children:[" ","Subir Foto"]})]}):Object(r.jsxs)(x.b,{active:!0,type:"primary",siguiente:d.toggleModal,children:[" ","Finalizar"]})})]})})},F=s(374),K=s(327),T=s(328);const M=T.b.section(N||(N=Object(K.a)(["\n  height: 100%;\n  width: 100%;\n  position: relative;\n  overflow: hidden;\n  display: grid;\n  grid-template-rows: 1fr;\n  grid-template-columns: 1fr;\n"]))),P=T.b.div(L||(L=Object(K.a)(["\n  height: 100%;\n  display: grid;\n  grid-template-rows: 1fr;\n  transition: 0.3s;\n  transform: ",";\n  width: ",";\n  grid-template-columns: ",";\n"])),(e=>1===e.position?"translateX(0px)":"translateX(-".concat(e.position,"px)")),(e=>e.width&&"".concat(e.width,"00%")),(e=>e.width?"repeat(".concat(e.width,", 1fr)"):"repeat(1, 1fr)")),B=T.b.div(I||(I=Object(K.a)(["\n  width: 100%;\n  height: 100%;\n  display: grid;\n  align-items: center;\n  justify-items: center;\n  position: relative;\n"]))),z=T.b.div(A||(A=Object(K.a)(["\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background: transparent;\n"]))),U=T.b.div(C||(C=Object(K.a)(["\n  overflow: hidden;\n  position: absolute;\n  align-self: center;\n  cursor: pointer;\n  transition: 0.3s;\n  background: white;\n  border-radius: 50%;\n  color: black;\n  opacity: 0.15;\n\n  &:hover {\n    opacity: 1;\n  }\n\n  &.left {\n    left: 15px;\n    transform: rotate(-90deg);\n    &:hover {\n      transform: rotate(-90deg) scale(1.3) !important;\n    }\n    &:active {\n      transition: 0.1s;\n      transform: rotate(-90deg) scale(1) !important;\n    }\n  }\n\n  &.right {\n    right: 15px;\n    transform: rotate(90deg);\n    &:hover {\n      transform: rotate(90deg) scale(1.3) !important;\n    }\n    &:active {\n      transition: 0.1s;\n      transform: rotate(90deg) scale(1) !important;\n    }\n  }\n"])));var E=e=>{const{config:t}=e,[s,i]=Object(a.useState)(),[c,n]=Object(a.useState)(1);Object(a.useEffect)((()=>{i(document.getElementById("Rj45#_SendaSlider"))}),[s]),Object(a.useEffect)((()=>{if(s&&s.childNodes){let e=1;for(let t of s.childNodes)t.classList.add("sendaSlider","slider_".concat(e)),e++}}),[s]);return Object(r.jsxs)(M,{onMouseOver:()=>{console.log("|||||||||||||||| Over ==>")},children:[Object(r.jsx)(P,{id:"Rj45#_SendaSlider",position:c,width:s&&s.childNodes.length,children:e.children}),s&&t&&t.controls&&Object(r.jsx)(W,{slider:s,setcurrentPosition:n,...e})]})};const W=e=>{let t,s,{config:{controls:i,autoSwap:c,swapInterval:n},slider:o,setcurrentPosition:l}=e,d=o.childNodes&&o.childNodes.length,p=i&&i.size||"35px",h=F.c;const[m,u]=Object(a.useState)(0),b=async e=>{e||clearInterval(s),t=o.clientWidth/o.childNodes.length,m<d-1?(l(t*(m+1)),u(m+1)):u(-1)},j={next:b,prev:async()=>{clearInterval(s),t=o.clientWidth/o.childNodes.length,m>0?(l(t*(m-1)),u(m-1)):u(o.childNodes.length)}};Object(a.useEffect)((()=>(c&&(s=setInterval((()=>{clearInterval(s),b(!0)}),n||1500)),()=>clearInterval(s))),[m]);const _=e=>{if(!o.childNodes||!o.childNodes.length)return!1;const{action:t}=e.target.dataset;j[t]()};return Object(r.jsxs)(a.Fragment,{children:[Object(r.jsx)(U,{className:"right",children:Object(r.jsxs)(B,{children:[Object(r.jsx)(z,{"data-action":"next",onClick:_}),Object(r.jsx)(h,{size:p})]})}),Object(r.jsx)(U,{className:"left",children:Object(r.jsxs)(B,{children:[Object(r.jsx)(z,{"data-action":"prev",onClick:_}),Object(r.jsx)(h,{size:p})]})})]})};s(647);class R extends a.Component{render(){const{onBoarding:e,continuar:t}=this.props;return Object(r.jsxs)("div",{className:"SimpleSlider",children:[Object(r.jsx)("h1",{className:"TitleSlider fuente",children:"La foto DEBE ser:"}),Object(r.jsxs)(E,{config:{autoSwap:!0,swapInterval:7e3,controls:{size:"50px"}},children:[Object(r.jsxs)("div",{className:"SimpleSliderItem",children:[Object(r.jsx)("h1",{className:"fuente",children:"Plana"}),Object(r.jsx)(w,{children:Object(r.jsx)("img",{src:"".concat(Object(u.b)("assets"),"kyc_identity/examples/perspective.png"),alt:"",width:"80%"})}),Object(r.jsx)("p",{className:"fuente",children:"La fotograf\xeda del documento debe ser recta, no puede tener perspectiva"})]}),Object(r.jsxs)("div",{className:"SimpleSliderItem",children:[Object(r.jsx)("h1",{className:"fuente",children:"Legible"}),Object(r.jsx)(w,{children:Object(r.jsx)("img",{src:"".concat(Object(u.b)("assets"),"kyc_identity/examples/borroso.png"),alt:"",width:"80%"})}),Object(r.jsx)("p",{className:"fuente",children:"Aseg\xfarese, que la identificaci\xf3n este totalmente visible y enfocada, incluidos su nombre completo, fecha de nacimiento y n\xfamero de identificaci\xf3n."})]}),Object(r.jsxs)("div",{className:"SimpleSliderItem",children:[Object(r.jsx)("h1",{className:"fuente",children:"Iluminada"}),Object(r.jsx)(w,{children:Object(r.jsx)("img",{src:"".concat(Object(u.b)("assets"),"kyc_identity/examples/oscuro.png"),alt:"",width:"80%"})}),Object(r.jsx)("p",{className:"fuente",children:"La imagen no debe estar oscura, procure tomarla con iluminaci\xf3n natural"})]}),Object(r.jsxs)("div",{className:"SimpleSliderItem",children:[Object(r.jsx)("h1",{className:"fuente",children:"A color"}),Object(r.jsx)(w,{children:Object(r.jsx)("img",{src:"".concat(Object(u.b)("assets"),"kyc_identity/examples/gris.png"),alt:"",width:"80%"})}),Object(r.jsx)("p",{className:"fuente",children:"La imagen no debe estar a blanco y negro"})]}),Object(r.jsxs)("div",{className:"SimpleSliderItem",children:[Object(r.jsx)("h1",{className:"fuente",children:"Entera"}),Object(r.jsx)(w,{children:Object(r.jsx)("img",{src:"".concat(Object(u.b)("assets"),"kyc_identity/examples/sinmarc.png"),alt:"",width:"100%"})}),Object(r.jsx)("p",{className:"fuente",children:"Aseg\xfarese, que las 4 esquinas del documento se vean completamente en el marco de la foto"})]})]}),e&&Object(r.jsx)("div",{className:"holi",children:Object(r.jsx)(x.b,{active:!0,type:"primary",siguiente:t,children:"Continuar"})})]})}}var V=s(332),Y=s(434);s(450);var $=e=>{const{dashboard:t,onBoarding:s,continuar:a,topOnBoarding:i,loader:c,step:n,kyc_success:o,finish:l}=e;return Object(r.jsx)("div",{className:"KycAvancedLayout",children:o?Object(r.jsx)(Y.a,{...e,confetti:!0,cta_secondary:!1,title:"!Lo has hecho muy bien!, tus documentos han sido enviados exitosamente y nuestro sistema se encuentra verific\xe1ndolos.",classes:"long_msg",cta_primary_text:"Finalizar",siguiente:l,user_name:e.user.name}):Object(r.jsxs)("div",{className:"containerKycAvanced ".concat(t&&n<5?"desktop":""),style:{top:"".concat(i,"vh")},children:[n<5&&window.innerWidth>768&&Object(r.jsx)("div",{className:"KYCAstep KycOnboarding",children:Object(r.jsx)(R,{onBoarding:s,continuar:a})}),Object(r.jsxs)("div",{className:"KYCAstep KycDashboard",children:[Object(r.jsx)("div",{className:"KycprogressBar",children:Object(r.jsx)("div",{className:"kycPropgressed",style:{width:1===n?"0%":2===n?"33%":3===n?"66%":"100%"}})}),c&&Object(r.jsx)("div",{className:"auxDesma",children:Object(r.jsx)(V.default,{label:"cargando"})}),Object(r.jsx)("div",{className:"KycDashContainer",children:Object(r.jsx)(D,{...e})})]})]})})};class J extends a.Component{constructor(){super(...arguments),this.state={kyc_success:!1,front:"pasaporte"===this.props.user.id_type?"".concat(Object(u.b)("assets"),"kyc_identity/front_passport.png"):"".concat(Object(u.b)("assets"),"kyc_identity/front.png"),back:"".concat(Object(u.b)("assets"),"kyc_identity/back.png"),selfie:"pasaporte"===this.props.user.id_type?"".concat(Object(u.b)("assets"),"kyc_identity/selfie_passport.png"):"".concat(Object(u.b)("assets"),"kyc_identity/selfie.png"),newfront:"pasaporte"===this.props.user.id_type?"".concat(Object(u.b)("assets"),"kyc_identity/front_passport.png"):"".concat(Object(u.b)("assets"),"kyc_identity/front.png"),newback:"".concat(Object(u.b)("assets"),"kyc_identity/back.png"),newselfie:"pasaporte"===this.props.user.id_type?"".concat(Object(u.b)("assets"),"kyc_identity/selfie_passport.png"):"".concat(Object(u.b)("assets"),"kyc_identity/selfie.png"),id_type:this.props.user.id_type,dashboard:window.innerWidth>768,fileloader:!1,prevState:this.props.step,animation:!1,animation2:!1,onBoarding:!(window.innerWidth>768),topOnBoarding:0,imageSrc:null,base64:{...this.props.base64}},this.goFileLoader=async e=>{if(e.target.files&&e.target.files.length>0){this.props.action.isAppLoading(!0);const t=await Object(m.img_compressor)(e.target.files[0]),s=await Object(m.readFile)(t);if(!Object(m.includesAnyImageMime)(s.split(",")[1]))return this.props.action.isAppLoading(!1),alert("Solo se aceptan imagenes");this.props.action.isAppLoading(!1),await this.subirImg({urlImg:s,base64:s}),this.setState({imageSrc:s,fileloader:!this.state.fileloader})}},this.subirImg=e=>{this.props.action.isAppLoading(!0);const{urlImg:t,base64:s}=e;this.props.action.isAppLoading(!1),this.setState({fileloader:!this.state.fileloader}),this.updateLocalImg(t,s),this.props.toastMessage("\xa1Imagen cargada con \xe9xito!","success")},this.updateLocalImg=async(e,t)=>{const s=1===this.props.step?"newfront":2===this.props.step?"newback":"newselfie";if(await this.setState({[s]:t,base64:{...this.state.base64,[s]:t},imageSrc:null}),await this.props.action.UpdateForm("kyc_advanced",this.state),this.props.step<=3)return setTimeout((()=>{this.stepChange()}),700)},this.cancelarSubidaImg=()=>{this.setState({fileloader:!1})},this.continuar=()=>{this.setState({topOnBoarding:-100})},this.stepChange=async()=>{if("pasaporte"===this.props.user.id_type&&1===this.props.step)return this.setState({prevState:3}),this.props.action.IncreaseStep("kyc_advanced",3);const e=this.props.step;await this.props.action.IncreaseStep("kyc_advanced");const t=this.props.step;if(t===e)return!1;if(await this.setState({animation:!1}),t<3)return setTimeout((()=>{this.setState({animation:!0})}),1),setTimeout((()=>{this.setState({animation2:!0})}),300),setTimeout((()=>{this.setState({prevState:t})}),500);this.setState({prevState:t});const{base64:s}=this.state,{newfront:a,newback:i,newselfie:c}=s;if(a&&i&&c||a&&c&&"pasaporte"===this.props.user.id_type){if(await this.props.validate_identity_kyc(this.state))return this.setState({kyc_success:!0});await this.setState({base64:{newfront:null,newback:null,newselfie:null}}),this.props.action.UpdateForm("kyc_advanced",this.state)}},this.finish=()=>{this.props.action.toggleModal()}}async componentDidMount(){await this.props.action.CurrentForm("kyc_advanced"),"kyc_advanced"===this.props.current&&(this.props.action.isAppLoading(!1),this.props.history.push("?form=identity_front_upload"))}componentWillUnmount(){document.onkeydown=!1}componentDidUpdate(e,t){if(e.step===this.props.step&&"kyc_advanced"===this.props.current)return;const{reset:s,step:a}=this.props;let i;s&&this.setState({animation:!1,animation2:!1,prevState:1}),2===a&&(setTimeout((()=>{this.setState({animation:!0})}),1),setTimeout((()=>{this.setState({animation2:!0})}),300)),this.props.user!==e.user&&this.setState({front:"pasaporte"===this.props.user.id_type?"./docs/front_passport.png":"./docs/front.png",selfie:"pasaporte"===this.props.user.id_type?"./docs/selfie_passport.png":"./docs/selfie.png",newfront:"pasaporte"===this.props.user.id_type?"./docs/front_passport.png":"./docs/front.png",newselfie:"pasaporte"===this.props.user.id_type?"./docs/selfie_passport.png":"./docs/selfie.png",id_type:this.props.user.id_type}),2===this.props.step&&(i="?form=identity_back_upload"),3===this.props.step&&(i="?form=identity_selfie_upload"),4===this.props.step&&(i="?form=identity_files_uploaded_success"),this.props.history.push(i)}render(){return console.log("||||||||||||||||||| KYC ADVANCED ==> getCdnPath ==> ","".concat(Object(u.b)("assets"),"kyc_identity/back.png")),Object(r.jsx)($,{stepChange:this.stepChange,goFileLoader:this.goFileLoader,continuar:this.continuar,subirImg:this.subirImg,cancelarSubidaImg:this.cancelarSubidaImg,finish:this.finish,...this.state,...this.props})}}var q=Object(d.b)((function(e,t){const{user:s}=e.modelData,{current:a}=e.form;return{loader:e.isLoading.loader,step:e.form.form_kyc_advanced.step,base64:e.form.form_kyc_advanced.base64,user:s,current:a}}),(function(e){return{action:Object(p.bindActionCreators)(h.a,e)}}))(Object(y.a)(J)),G=s(53);const X=Object(G.a)((()=>Promise.resolve().then(s.bind(null,330))));class Z extends a.Component{constructor(){super(...arguments),this.state={current_name:null,current_value:null,data_state:{},imageSrc:null,open_sect:null,kyc_financial_list:[],widthBar:"0%",availableCta:!1},this.init_component=async()=>{this.props.action.isAppLoading(!0);const{user:e,step:t}=this.props;let s=await this.props.coinsendaServices.countryValidators();if(!s)return!1;const{financial:a}=s.res.levels.level_2;let i=a[e.person_type],c=await Object(m.addIndexToRootObject)(i),n=await Object(m.converToInitState)(c),r=await Object(m.objectToArray)(c,!0);await this.setState({current_name:r[t-1].ui_name,current_value:r[t-1].value,data_state:n,kyc_financial_list:r}),this.props.action.isAppLoading(!1)},this.goFileLoader=async e=>{if(e.target.files&&e.target.files.length>0){let t={name:e.target.files[0].name,type:e.target.files[0].type};const s=await Object(m.img_compressor)(e.target.files[0]),a=await Object(m.readFile)(s);t.base64=a,await this.setState({data_state:{...this.state.data_state,[this.state.current_value]:t},widthBar:"100%",availableCta:!0})}},this.send_files=async()=>{const{data_state:e}=this.state;this.props.action.isAppLoading(!0);let t={};await Object.keys(e).forEach((s=>{t={...t,[s]:e[s].base64}})),this.props.validate_financial_kyc(t,this.setState)},this.finish=()=>{this.props.action.toggleModal(!1)}}componentDidMount(){this.init_component()}render(){const{current_name:e,data_state:t,kyc_financial_list:s,widthBar:i,availableCta:c}=this.state,{loader:n,financial_success:o}=this.props;return Object(r.jsx)(a.Fragment,{children:o?Object(r.jsx)(Y.a,{...this.props,name:this.props.user.name,confetti:!0,cta_secondary:!1,title:"!Lo has hecho muy bien!, tus documentos han sido enviados exitosamente, los analizaremos y te pondremos al tanto de novedades lo m\xe1s pronto posible.",classes:"long_msg",cta_primary_text:"Finalizar",siguiente:this.finish,user_name:this.props.user.name}):Object(r.jsxs)("div",{className:"KycFinancialComponent",children:[Object(r.jsx)(X,{icon:"kyc_financial",color:"#0066AA",size:50}),Object(r.jsx)("p",{className:"fuente",children:"Completa la verificaci\xf3n financiera para operar con cantidades superiores a $7.000 dolares al mes."}),Object(r.jsxs)("div",{className:"panelImgFinancial",children:[n&&Object(r.jsx)("div",{className:"loaderFinancial",children:Object(r.jsx)("div",{className:"loaderFinancial_cont",children:Object(r.jsx)(V.default,{label:"Cargando..."})})}),Object(r.jsxs)("div",{className:"FinancialUploadImg",style:{width:"calc(100% - 40px)"},children:[Object(r.jsx)("div",{className:"KycprogressBar financial loader",children:Object(r.jsx)("div",{className:"kycPropgressed",style:{width:i}})}),Object(r.jsxs)("div",{className:"loaderImgComponent",style:{opacity:c?".4":"1"},children:[Object(r.jsx)("input",{type:"file",id:"uploadIMGF",accept:S.a.join(),onChange:this.goFileLoader}),Object(r.jsxs)("div",{className:"payloadFinancial",children:[Object(r.jsx)(X,{icon:"upload",size:70,color:"#3e87d9"}),Object(r.jsxs)("div",{className:"fuente textFinancial",children:["Toca para cargar el archivo .JPG/.PNG/.PDF de tu"," ",e]})]})]})]}),Object(r.jsx)("div",{className:"FinancialUploaded",style:{width:"250px"},children:s.length>0&&s.map((e=>Object(r.jsxs)("div",{className:"item_loaded",style:{opacity:t[e.value]?"1":"0.4"},children:[Object(r.jsx)("div",{className:"contIconS",children:t[e.value]?Object(r.jsx)(X,{icon:"success",size:100,color:"white"}):Object(r.jsx)(X,{icon:"upload",size:70,color:"white"})}),Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{className:"item_loaded_text fuente",children:e.ui_name}),Object(r.jsx)("p",{className:"item_loaded_text fileName fuente2",children:t[e.value]?t[e.value].name:"..."})]}),t[e.value]&&Object(r.jsx)("img",{src:"image/jpeg"===t[e.value].type||"image/png"===t[e.value].type?"".concat(Object(u.b)("assets"),"pictures.png"):"".concat(Object(u.b)("assets"),"pdf.png"),alt:"",width:"30px"})]},e.id)))})]}),Object(r.jsx)("div",{className:"Kyccontrols",children:Object(r.jsx)("div",{className:"Kcontrols",children:Object(r.jsx)(x.b,{active:c,type:"primary",siguiente:this.send_files,children:"\xa1Enviar!"})})})]})})}}var H=Object(d.b)((function(e,t){const{user:s}=e.modelData,{step:a}=e.form.form_kyc_financial;return{step:a,loader:e.isLoading.loader,user:s}}),(function(e){return{action:Object(p.bindActionCreators)(h.a,e)}}))(Object(y.a)(Z));var Q=e=>{const{globalStep:t,validate_personal_kyc:s,validate_financial_kyc:a,identity_success:i,showSuccess:c}=e;return Object(r.jsxs)("section",{className:"KycLayoutMom",children:[Object(r.jsxs)("div",{className:"KycLayoutCarousel ".concat(0===t?"globalStep0":1===t?"globalStep1":"globalStep2"),style:{display:t<3?"grid":"none"},children:["accepted"!==e.user.security_center.kyc.basic&&"confirmed"!==e.user.security_center.kyc.basic?Object(r.jsx)(O,{validate_personal_kyc:s,...e}):Object(r.jsx)("div",{}),c?Object(r.jsx)(Y.a,{...e,title:"Has completado de forma exitosa el proceso de verificaci\xf3n b\xe1sica",cta_text:"\xbfQuieres continuar con el proceso de verifiaci\xf3n avanzada?",confetti:0===t||1===t,cta_secondary:!0,cta_primary_text:"Continuar verificaci\xf3n",user_name:e.user.name}):Object(r.jsx)("div",{}),Object(r.jsxs)("div",{className:"KycLayout",children:[!i&&Object(r.jsx)("p",{className:"fuente KycTitle",children:"Verificaci\xf3n Avanzada"}),2===t&&Object(r.jsx)(q,{...e})]})]}),3===t&&Object(r.jsxs)("div",{className:"KycLayout",style:{display:t>2?"grid":"none"},children:[Object(r.jsx)("p",{className:"fuente KycTitle financial",children:"Verificaci\xf3n Financiera"}),Object(r.jsx)(H,{...e,validate_financial_kyc:a})]})]})},ee=s(338),te=s(10),se=s.n(te);t.default=Object(d.b)((function(e,t){const{user:s}=e.modelData,{current:a}=e.form;return{loader:e.isLoading.loader,globalStep:e.form.globalStep,user:s,form_kyc_basic:e.form.form_kyc_basic,current:a}}),(function(e){return{action:Object(p.bindActionCreators)(h.a,e)}}))(Object(y.a)((e=>{const[t,s]=Object(a.useState)(),[i,c]=Object(a.useState)(),[n,o]=Object(a.useState)(!1),[l]=Object(ee.a)(),[d,p]=Object(a.useState)(!1);return Object(r.jsx)(Q,{validate_personal_kyc:async()=>{const{form_kyc_basic:t,user:s}=e,{data_state:a}=t;let i={info:{name:a.name.trim(),surname:a.surname.trim(),birthday:a.birthday,address:a.address.trim(),phone:"+".concat(a.country_prefix[0].prefix[0]).concat(a.phone),city:a.city.trim(),country:a.country[0].code&&a.country[0].code.trim(),id_type:a.id_type[0].code&&a.id_type[0].code.trim(),id_number:a.id_number.trim(),nationality:a.nationality[0].code&&a.nationality[0].code.trim()},info_type:"personal",verification_level:"level_1"};const c=new Date(i.info.birthday).getTime();i.info.birthday=se()(c).div(1e3).toString(),e.action.isAppLoading(!0);let n=await e.coinsendaServices.updateLevelProfile(i,s);if(!n)return e.action.isAppLoading(!1),l("No puedes verificarte en este momento, intenta m\xe1s tarde","error"),e.action.CleanForm("kyc_basic");const{data:r}=n,{personal:o}=r;let d={...s,...o,levels:{...s.levels,personal:"confirmed"},security_center:{...s.security_center,kyc:{...s.security_center.kyc,basic:"confirmed"}},country:s.country};await e.coinsendaServices.updateUser(d),e.action.IncreaseStep("kyc_global_step"),e.action.success_sound(),e.action.isAppLoading(!1),p(!0)},validate_identity_kyc:async t=>{let{base64:a}=t;const{user:i}=e,{newselfie:c,newfront:n,newback:r}=a;let d={info:{selfie:c,id_front:n,id_back:"pasaporte"===i.id_type?n:r},info_type:"identity",verification_level:"level_1"};if(e.action.isAppLoading(!0),!await e.coinsendaServices.updateLevelProfile(d,i))return await e.action.ReduceStep("kyc_advanced",1),await s(!0),e.action.isAppLoading(!1),l("No puedes verificarte en este momento, intenta m\xe1s tarde","error");let h={...i,levels:{...i.levels,identity:"confirmed"},security_center:{...i.security_center,kyc:{...i.security_center.kyc,advanced:"confirmed"}}};return await e.coinsendaServices.updateUser(h),e.action.isAppLoading(!1),o(!0),p(!0),!0},validate_financial_kyc:async t=>{const{user:s}=e;let a={info:t,info_type:"financial",verification_level:"level_2"};if(!await e.coinsendaServices.updateLevelProfile(a,s))return e.action.isAppLoading(!1),l("No puedes verificarte en este momento, intenta m\xe1s tarde","error");e.action.success_sound(),c(!0);let i={...s,levels:{...s.levels,financial:"confirmed"},security_center:{...s.security_center,kyc:{...s.security_center.kyc,financial:"confirmed"}}};await e.coinsendaServices.updateUser(i),e.action.isAppLoading(!1),p(!0)},siguiente:()=>{e.action.IncreaseStep("kyc_global_step"),p(!1)},showSuccess:d,exit:()=>{e.action.toggleModal(!1),p(!1)},...e,reset:t,financial_success:i,identity_success:n})})))}}]);
//# sourceMappingURL=48.f27ad3fc.chunk.js.map