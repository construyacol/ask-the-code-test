(this["webpackJsonpcoinsenda-app"]=this["webpackJsonpcoinsenda-app"]||[]).push([[5,8,17,18,20,58],{390:function(e,n,t){"use strict";t.r(n);var a,i,r=t(327),o=t(2),c=t(328),s=t(345),l=t(370),d=t(14);const u=Object(c.c)(a||(a=Object(r.a)(["\n    0% {\n        opacity: 1;\n        transform: scale(1);\n    }\n    30% {\n        transform: scale(0);\n        opacity: 0;\n    }\n    50%{\n        transform: scale(0);\n        opacity: 0;\n    }\n    80%{\n        opacity: 1;\n        transform: scale(1.3);\n    }\n    100%{\n        opacity: 1;\n        transform: scale(0.9);\n        background:#2ad083;\n        border: 4px solid white;\n    }\n    "]))),p=c.b.div(i||(i=Object(r.a)(["\n      width: 60px;\n      height: 60px;\n      position: absolute;\n      border-radius: 50%;\n      background: white;\n      border: 2px solid #cfcfcf;\n      top:175px;\n      right:200px;\n      z-index: 1;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      &.approve{\n         animation: "," .6s linear forwards;\n      }\n\n     \n\n    @media (max-width: 768px) {\n      top: 380px;\n      right: 0;\n      left: 50px;\n    }\n  "])),u);n.default=e=>{let{data:n}=e;const[t,a]=Object(o.useState)();return Object(o.useEffect)((()=>{n?a("approve"):setTimeout((()=>a()),400)}),[n]),Object(d.jsx)(p,{className:"".concat("approve"===t?"approve":"normal"),children:t?Object(d.jsx)(l.e,{size:37,color:"white"}):Object(d.jsx)(s.d,{size:30,color:"#a3a3a3"})})}},405:function(e,n,t){"use strict";t.r(n),t.d(n,"getDisplaySize",(function(){return a})),t.d(n,"getFrame",(function(){return i}));const a=()=>{const e=document.querySelector("#streamingVideo");return{width:e.clientWidth,height:e.clientHeight}},i=()=>{const{width:e,height:n}=a(),t=document.querySelector("#faceApiCanvas");t.width=e,t.height=n;const i=document.querySelector("#streamingVideo");return t.getContext("2d").drawImage(i,0,0,e,n),t.toDataURL("image/jpeg")}},418:function(e,n,t){"use strict";t.r(n);var a,i=t(327),r=t(328),o=t(14);n.default=e=>{let{state:n}=e;return Object(o.jsx)(c,{id:"captures",children:Object.keys(n).map(((e,t)=>Object(o.jsx)("img",{src:n[e],width:"100%",alt:""},t)))})};const c=r.b.div(a||(a=Object(i.a)(["\n    position: absolute;\n    width: 150px;\n    height: auto;\n    min-height: 120px;\n    z-index: 2;\n    background: #ededed;\n    bottom: 10px;\n    right: 10px;\n    border-radius: 6px;\n    border: 3px solid darkgrey;\n"])))},420:function(e,n,t){"use strict";t.r(n),t.d(n,"Scanner",(function(){return s}));var a,i,r=t(327),o=t(328);const c=Object(o.c)(a||(a=Object(r.a)(["\n    0% {\n        top:0%\n    }\n    15%{\n        top:30%\n    }\n    35%{\n        top:70%\n    }\n    50%{\n        top:100%\n    }\n    65%{\n        top:70%\n    }\n    85%{\n        top:30%\n    }\n    100%{\n        top:0%;\n    }\n"]))),s=o.b.div(i||(i=Object(r.a)(["\n    height: 3px;\n    width: 100%;\n    position: absolute;\n    top: 0%;\n    transition: .3s;\n    filter: blur(0.1em);\n    background: rgb(255 255 255 / 10%);;\n    animation: "," 1.2s linear infinite;\n    &.scanning{\n    background: #2ad083;\n    }\n"])),c)},427:function(e,n,t){"use strict";t.r(n);var a=t(327),i=t(2),r=t(354),o=t(471);var c=function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=Object(r.f)(),[c,s]=Object(i.useState)(),[l,d]=Object(i.useState)(t),[u,p]=Object(i.useState)(n[e[l]]),g=()=>{l>=e.length||d((e=>e+1))},v=()=>{l<=0||d((e=>e-1))};return Object(i.useEffect)((()=>{var e;if(null===u||void 0===u||null===(e=u.settings)||void 0===e?void 0:e.queryParams){let e=Object(o.b)(u.settings.queryParams);a.push(e)}}),[u]),Object(i.useEffect)((()=>{const t=n[e[l]];p(t)}),[l,n[e[l]]]),{currentStage:l,nextStage:g,prevStage:v,stageController:e,stageData:u,setStageData:p,stageStatus:c,setStageStatus:s,finalStage:l>=e.length}},s=t(405);const l=(e,n)=>{var t,a;let i;return console.log("|||||| detections smile",null===e||void 0===e||null===(t=e.expressions)||void 0===t?void 0:t.happy),(null===e||void 0===e||null===(a=e.expressions)||void 0===a?void 0:a.happy)>.97&&!n.state[n.key]&&(i=Object(s.getFrame)()),[i]},d=(e,n)=>{var t,a;let i;return console.log("|||||| detections surprised",null===e||void 0===e||null===(t=e.expressions)||void 0===t?void 0:t.surprised),(null===e||void 0===e||null===(a=e.expressions)||void 0===a?void 0:a.surprised)>.95&&!n.state[n.key]&&(i=Object(s.getFrame)()),[i]};var u,p,g,v,b,h=()=>({smile:l,surprised:d}),m=t(53),j=t(328),f=t(390),x=t(420),O=t(418),w=t(15),y=t(412),S=t(333),k=(t(469),t(14));const F="".concat(Object(w.b)("tensor"),"/"),z=Object(m.a)((()=>Promise.resolve().then(t.bind(null,654))));n.default=e=>{var n,t,a,r;let{handleDataForm:o,handleState:l}=e;const{dataForm:d}=o,{state:u,setState:p}=l,[g,v]=Object(i.useState)(!1),[b,m]=Object(i.useState)(),[j,A]=Object(i.useState)(!1),[E]=Object(S.a)(),L=h(),M=Object(i.useRef)(null);let q=Object(i.useRef)(null);const T=Object(i.useRef)(window.faceapi),[I]=Object(i.useState)(null===(n=window)||void 0===n||null===(t=n.location)||void 0===t||null===(a=t.search)||void 0===a?void 0:a.includes("developer=true")),G=c(Object.keys((null===d||void 0===d||null===(r=d.handleError)||void 0===r?void 0:r.errors)||d.stages),d.stages),{stageData:P,currentStage:V,stageController:B,nextStage:J,finalStage:_}=G,H=async()=>{if(v(!0),!window.faceapi)return alert("No est\xe1n cargando las librer\xedas");T.current=window.faceapi,await T.current.nets.tinyFaceDetector.loadFromUri(F),await T.current.nets.faceLandmark68Net.loadFromUri(F),await T.current.nets.faceRecognitionNet.loadFromUri(F),await T.current.nets.faceExpressionNet.loadFromUri(F),Q()},W=e=>{m(!0),M.current.srcObject=e},K=e=>{console.log("No hay camara conectada o los permisos han sido denegados",e),m(!1)},Q=()=>{navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,navigator.getUserMedia&&(navigator.getUserMedia({video:!0},W,K),M.current.addEventListener("play",(()=>{console.log("el streaming a comenzado",T.current);const e=T.current.createCanvasFromMedia(M.current);e.style.display="none",e.id="faceApiCanvas",document.querySelector("#videoContainer").append(e),T.current.matchDimensions(e,Object(s.getDisplaySize)()),v(!1)})))},X=(e,n)=>{const t=document.querySelector(".FRecScanner");let a=1;q.current=setInterval((async()=>{const n=await T.current.detectAllFaces(M.current,new T.current.TinyFaceDetectorOptions).withFaceLandmarks().withFaceDescriptors().withFaceExpressions();if(I&&((e,n)=>{e.style.display="initial";const t=T.current.resizeResults(n,Object(s.getDisplaySize)());e.getContext("2d").clearRect(0,0,e.width,e.height),T.current.draw.drawFaceLandmarks(e,t),T.current.draw.drawDetections(e,t),T.current.draw.drawFaceExpressions(e,t)})(e,n),null===n||void 0===n?void 0:n.length){var i,r;if(console.log("validations",null===P||void 0===P?void 0:P.key),t&&!(null===t||void 0===t||null===(i=t.classList)||void 0===i||null===(r=i.value)||void 0===r?void 0:r.includes("scanning"))&&t.classList.add("scanning"),!L[null===P||void 0===P?void 0:P.key])return;const[o]=L[P.key](n[0],{...P,state:u,dataForm:d});if(!o||a>1)return;e.style.display="none",p((e=>({...e,[null===P||void 0===P?void 0:P.key]:o||e[null===P||void 0===P?void 0:P.key]}))),clearInterval(q.current),a++;const c=await E.addNewBiometricData({file:o.split(",")[1],biometric_id:P.biometricId,challenge_name:P.key});console.log(c),setTimeout((()=>J()),1500)}else{var o;console.log("Detectando..."),t&&(null===t||void 0===t||null===(o=t.classList)||void 0===o?void 0:o.value.includes("scanning"))&&t.classList.remove("scanning")}}),n)};var Y;return Object(i.useEffect)((()=>{const e=document.querySelector("#faceApiCanvas"),n=d.stages[B[V]];return j&&e&&P===n&&!u[null===n||void 0===n?void 0:n.key]&&!_&&X(e,600),()=>clearInterval(q.current)}),[P,j,g]),Object(i.useEffect)((()=>(Object(y.a)(H,"".concat(Object(w.b)("faceApi")),"faceApi"),()=>{var e,n,t;null===(e=M.current)||void 0===e||e.pause(),null===(n=M.current)||void 0===n||null===(t=n.srcObject)||void 0===t||t.getTracks()[0].stop()})),[]),_?Object(k.jsxs)(k.Fragment,{children:[I&&Object(k.jsx)(O.default,{state:u}),Object(k.jsx)(z,{component:null===d||void 0===d||null===(Y=d.successStage)||void 0===Y?void 0:Y.component,handleDataForm:o,handleState:l})]}):Object(k.jsxs)(D,{children:[!j&&Object(k.jsx)(z,{component:"onBoardingAgreement",cameraAvailable:b,handleAction:()=>{A(!0)}}),I&&Object(k.jsx)(O.default,{state:u}),Object(k.jsxs)(R,{id:"faceApiContainer",children:[Object(k.jsx)(f.default,{data:u[null===P||void 0===P?void 0:P.key]}),Object(k.jsx)("h3",{className:"FRecTitle fuente",children:"Reconocimiento Facial"}),Object(k.jsxs)(C,{id:"videoContainer",children:[g&&Object(k.jsx)("div",{className:"biometricLoaderContainer"}),!I&&Object(k.jsx)(x.Scanner,{className:"FRecScanner"}),Object(k.jsx)("video",{id:"streamingVideo",autoPlay:!0,ref:M,width:"100%",height:"100%"})]}),Object(k.jsxs)(U,{children:[Object(k.jsx)(N,{className:"".concat(0===V?"active":"")}),Object(k.jsx)(N,{className:"".concat(1===V?"active":"")})]}),Object(k.jsx)("h1",{className:"fuente",children:null===P||void 0===P?void 0:P.uiName}),Object(k.jsx)("p",{className:"fuente",children:"Mant\xe9n tu cabeza erguida y asegurate que tu rostro encaje dentro del circulo"})]})]})};const D=j.b.div(u||(u=Object(a.a)(["\n    display: grid;\n    width: 100vw;\n    height: 100vh;\n    background: #fffffffa;\n    position: absolute;\n    justify-items: center;\n    top: 0;\n    left: 0;\n"]))),N=j.b.div(p||(p=Object(a.a)(["\n  width:7px;\n  height:12px;\n  background:#c9c9c9;\n  border-radius:5px;\n  margin:0 4px;\n  transition:.3s;\n  &.active{\n    height:22px;\n    background:#0198ff;\n  }\n"]))),U=j.b.div(g||(g=Object(a.a)(["\n  height:30px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]))),C=j.b.div(v||(v=Object(a.a)(["\n  position: relative;\n  clip-path: circle(37% at 50% 50%);\n"]))),R=j.b.div(b||(b=Object(a.a)(["\n\n  position:relative;\n  width:100vw;\n  height:auto;\n  max-width:800px;\n  display: grid;\n  grid-template-columns: 1fr;\n  grid-template-rows: auto 1fr auto auto auto;\n  height: calc(100vh - 80px);\n  padding: 40px 0;\n\n  .FRecTitle{\n    color:#0198ff;\n    font-weight:bold;\n  }\n  p{\n    text-align:center;\n    color:gray;\n    font-size: 1.2em;\n    max-width: 500px;\n    justify-self: center;\n  }\n  h1{\n    text-align:center;\n    font-size: 2.7em;\n    margin-bottom:0;\n  }\n  h3{\n    span{\n      color: transparent;\n      border-radius: 50%;\n      background: #2ad083;\n      margin-right: 10px;\n      font-size:15px;\n    }\n  }\n  @media (max-width: 768px) {\n  ","{\n    clip-path: circle(29% at 50% 50%);\n  }\n\n  padding: 30px 20px;\n  width:calc(100vw - 40px);\n\n  p{\n    font-size:1em;\n  }\n  h1{\n    font-size:2em;\n  }\n\n}\n"])),C)},469:function(e,n,t){}}]);
//# sourceMappingURL=5.c62ad8c2.chunk.js.map