(this["webpackJsonpcoinsenda-app"]=this["webpackJsonpcoinsenda-app"]||[]).push([[8,49,50,51,53,65,100],{448:function(n,e,t){"use strict";t.r(e),t.d(e,"showButton",(function(){return g})),t.d(e,"Button",(function(){return v})),t.d(e,"showWelcome",(function(){return m})),t.d(e,"hideWelcome",(function(){return h})),t.d(e,"flipInVerRight",(function(){return j})),t.d(e,"tiltInFwdTl",(function(){return x})),t.d(e,"Container",(function(){return y})),t.d(e,"Layout",(function(){return O})),t.d(e,"ContentContainer",(function(){return w})),t.d(e,"Content",(function(){return S}));var a,i,r,o,c,s,l,d,u,p,f=t(5),b=t(6);const g=Object(b.c)(a||(a=Object(f.a)(["\n    0% {\n      filter: grayscale(1) blur(1px);\n        opacity:.1;\n    }\n    20% {\n      filter: grayscale(1) blur(0px);\n      opacity:.1;\n    }\n    90% {\n      filter: grayscale(1) blur(0px);\n      opacity:.1;\n    }\n   \n    100%{\n      filter: grayscale(0) blur(0px);\n        opacity:1;\n    }\n"]))),v=b.b.button(i||(i=Object(f.a)(["\n  background: #0198ff;\n  font-size: 17px;\n  font-weight: bold;\n  width:270px;\n  height:60px;\n  border-radius:5px;\n  border: none;\n  color: white;\n  cursor:pointer;\n  position:absolute;\n  bottom:40px;\n  opacity:.1;\n  filter: grayscale(1) blur(1px);\n\n  &.showButton{\n    animation: "," .8s linear forwards;\n  }\n\n"])),g),m=Object(b.c)(r||(r=Object(f.a)(["\n    0% {\n        transform: translateY(50px);\n        filter:blur(5px);\n        opacity:0;\n    }\n    50% {\n        transform: translateY(50px);\n        filter:blur(1px);\n        opacity:0;\n    }\n    100%{\n        transform: translateY(0px);\n        filter:blur(0px);\n        opacity:1;\n    }\n"]))),h=Object(b.c)(o||(o=Object(f.a)(["\n    0% {\n        transform: translateY(0px);\n        filter:blur(0px) grayscale(0.2);\n        opacity:1;\n        \n    }\n    60% {\n        transform: translateY(5px);\n        filter:blur(3px) grayscale(1);\n        opacity:1;\n    }\n    100%{\n        transform: translateY(-70px);\n        filter:blur(5px) grayscale(1);\n        opacity:0;\n    }\n"]))),j=Object(b.c)(c||(c=Object(f.a)(["\n  0% {\n    transform: rotateY(80deg);\n    opacity: 0;\n  }\n  100% {\n    transform: rotateY(0);\n    opacity: 1;\n  }\n"]))),x=Object(b.c)(s||(s=Object(f.a)(["\n    0% {\n            transform: rotateY(-65deg) rotateX(35deg) translate(-60px, -60px) skew(45deg, -20deg);\n    opacity: 0;\n  }\n  50%{\n    opacity: 1;\n  }\n  100% {\n            transform: rotateY(0) rotateX(0deg) translate(0, 0) skew(0deg, 0deg);\n    opacity: 1;\n  }\n"]))),y=b.b.div(l||(l=Object(f.a)(["\n    &.show_{\n        animation: "," .5s linear forwards;\n    }\n    &.hide_{\n        animation: "," .5s linear forwards;\n    }\n\n    row-gap: ",";\n\n    perspective: 500px;\n    perspective-origin: calc(50% + 120px) 50%;\n\n    .flip-in-ver-right {\n        animation: "," 0.6s .25s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n    \n    }\n    display: grid;\n    align-items: center;\n    justify-items: center;\n    transform: translateY(50px);\n    opacity:0;\n\n    h1, h2{\n        color: #50667a;\n        font-size: 30px;\n        margin: 0;\n        font-weight:300;\n    }\n    span{\n        font-size:45px;\n    }\n"])),m,h,(n=>n.rowGap?"".concat(n.rowGap,"px"):0),x),O=b.b.div(d||(d=Object(f.a)(["\n    display: grid;\n    width: 100vw;\n    height: 100vh;\n    background: #ffffffff;\n    position: absolute;\n    justify-items: center;\n    top: 0;\n    left: 0;\n    z-index:1000;\n  @media screen and (max-height: 900px){\n    height: 140vh;\n  }\n"]))),w=b.b.div(u||(u=Object(f.a)(["\n  position:relative;\n  width:100vw;\n  height:auto;\n  max-width:800px;\n  display: grid;\n  grid-template-columns: 1fr;\n  grid-template-rows: auto 1fr auto auto auto;\n  height: calc(100vh - 80px);\n  padding: 40px 0;\n"]))),S=b.b.section(p||(p=Object(f.a)(['\n  width:100vw;\n  height:100vh;\n  display:grid;\n  position:relative;\n  align-items:center;\n  justify-items:center;\n  \n  [alt="isoType"]{\n    position: absolute;\n    margin: auto;\n    top: 30px;\n    left: 40px;\n    left: 0px;\n    right:0;\n  }\n'])))},465:function(n,e,t){"use strict";t.r(e);var a=t(5),i=t(2),r=t(550);var o=n=>{const[e,a]=Object(i.useState)();return Object(i.useEffect)((()=>{(async()=>{var e;let i={};try{i=await t(705)("./".concat(n,"/validations"))}catch(r){console.log(r)}a(null===(e=i)||void 0===e?void 0:e.default)})()}),[]),e},c=t(477),s=t(4),l=t(6),d=t(492),u=t(495),p=t(493),f=t(21),b=t(158),g=t(44),v=t(597),m=t.n(v),h=t(23);var j,x,y,O,w=t(9),S=t(3),k=t(448),C=(t(551),t(1));const F="development"===S.p?"/models":"".concat(Object(f.b)("tensor"),"/"),D=Object(s.a)((()=>Promise.resolve().then(t.bind(null,483))));e.default=n=>{var e,t,a,s;let{handleDataForm:l,handleState:v,...j}=n;const x=Object(w.d)((n=>n.modelData)),{dataForm:y}=l,O=null===y||void 0===y?void 0:y.wrapperComponent,{state:S,setState:A}=v,[L,R]=Object(i.useState)(!1),[M,T]=Object(i.useState)(),[Y,q]=Object(i.useState)(!1),[_]=Object(g.a)(),I=o(O),B=Object(i.useRef)(null);let G=Object(i.useRef)(null);const P=Object(i.useRef)(window.faceapi),[V]=Object(i.useState)(null===(e=window)||void 0===e||null===(t=e.location)||void 0===t||null===(a=t.search)||void 0===a?void 0:a.includes("developer=true")),[K]=function(n,e){const{SocketUrl:t}=f.a,a=m()(t),[r,o]=Object(i.useState)(),c=async()=>{const{userToken:n}=await Object(h.c)(),e={body:{access_token:n}};a.emit("authentication",e)};return Object(i.useEffect)((()=>{a.on("connect",c),a.on("authenticated",(()=>{a.on(n,(n=>{o((e=>({...e,...n})))}))}))}),[]),[r]}("/biometric_data/".concat(x.authData.userId)),W=Object(r.a)(Object.keys((null===y||void 0===y||null===(s=y.handleError)||void 0===s?void 0:s.errors)||y.stages),y.stages),{stageData:J,currentStage:X,nextStage:H,finalStage:Q,setStageData:Z,stageController:$}=W,nn=async()=>{if(R(!0),!window.faceapi)return alert("No est\xe1n cargando las librer\xedas FACE_API");P.current=window.faceapi,await P.current.nets.tinyFaceDetector.loadFromUri(F),await P.current.nets.faceLandmark68Net.loadFromUri(F),await P.current.nets.faceRecognitionNet.loadFromUri(F),await P.current.nets.faceExpressionNet.loadFromUri(F),an()},en=n=>{T(!0),B.current&&(B.current.srcObject=n)},tn=n=>{console.log("No hay camara conectada o los permisos han sido denegados",n),T(!1)},an=()=>{if(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,navigator.getUserMedia){var n;if(navigator.getUserMedia({video:!0},en,tn),!(null===(n=B.current)||void 0===n?void 0:n.addEventListener))return;B.current.addEventListener("play",(()=>{console.log("el streaming a comenzado",P.current);const n=P.current.createCanvasFromMedia(B.current);n.style.display="none",n.id="faceApiCanvas",document.querySelector("#videoContainer").append(n),P.current.matchDimensions(n,Object(c.getDisplaySize)()),R(!1)}))}},rn=(n,e)=>{const t=document.querySelector(".FRecScanner");let a=1;G.current=setInterval((async()=>{const e=await P.current.detectAllFaces(B.current,new P.current.TinyFaceDetectorOptions).withFaceLandmarks().withFaceDescriptors().withFaceExpressions();if(V&&((n,e)=>{n.style.display="initial";const t=P.current.resizeResults(e,Object(c.getDisplaySize)());n.getContext("2d").clearRect(0,0,n.width,n.height),P.current.draw.drawFaceLandmarks(n,t),P.current.draw.drawDetections(n,t),P.current.draw.drawFaceExpressions(n,t)})(n,e),null===e||void 0===e?void 0:e.length){var i,r;if(console.log("validations",null===J||void 0===J?void 0:J.key),t&&!(null===t||void 0===t||null===(i=t.classList)||void 0===i||null===(r=i.value)||void 0===r?void 0:r.includes("scanning"))&&t.classList.add("scanning"),!I[null===J||void 0===J?void 0:J.key])return;const[o]=I[J.key](e[0],{...J,state:S,dataForm:y});if(!o||a>1)return;n.style.display="none",A((n=>({...n,[null===J||void 0===J?void 0:J.key]:o||n[null===J||void 0===J?void 0:J.key]}))),clearInterval(G.current),a++;const c=await _.addNewBiometricData({file:o.split(",")[1],biometric_id:J.biometricId,challenge_name:J.key});!1===(null===c||void 0===c?void 0:c.data)&&on(),console.log("|||||||||||||||  addNewBiometricData res ==> ",c)}else{var o;console.log("Detectando..."),t&&(null===t||void 0===t||null===(o=t.classList)||void 0===o?void 0:o.value.includes("scanning"))&&t.classList.remove("scanning")}}),e)};Object(i.useEffect)((()=>{const n=document.querySelector("#faceApiCanvas");return Y&&n&&!(null===J||void 0===J?void 0:J.solved)&&!Q&&rn(n,600),()=>clearInterval(G.current)}),[J,Y,L]);const on=()=>{Z((n=>({...n,solved:!0}))),setTimeout((()=>H()),1500)};return Object(i.useEffect)((()=>{if(console.log("|||||||||||||  biometricData ==> ",K),"accepted"!==(null===K||void 0===K?void 0:K.state)||M||(console.log("cameraAvailable",M),(async()=>{const n=await _.getUserBiometric();(null===n||void 0===n?void 0:n.solved)&&H($.length+1)})()),(null===K||void 0===K?void 0:K.challenge_name)===(null===J||void 0===J?void 0:J.key))if("accepted"===K.state)on();else if("rejected"===K.state){A((n=>({...n,[null===J||void 0===J?void 0:J.key]:""})));const n=document.querySelector("#faceApiCanvas");rn(n,600)}}),[K]),Object(i.useEffect)((()=>{if(Q){(async()=>await _.disableTransactionSecutiry("biometric"))()}}),[Q]),Object(i.useEffect)((()=>(Object(b.a)(nn,"".concat(Object(f.b)("faceApi")),"faceApi"),()=>{var n,e,t;null===(n=B.current)||void 0===n||n.pause(),null===(e=B.current)||void 0===e||null===(t=e.srcObject)||void 0===t||t.getTracks()[0].stop()})),[]),Q?Object(C.jsxs)(C.Fragment,{children:[V&&Object(C.jsx)(p.default,{state:S}),Object(C.jsx)(D,{component:"".concat(null===y||void 0===y?void 0:y.wrapperComponent,"/success"),handleDataForm:l,handleState:v,coinsendaServices:_,...j})]}):Object(C.jsxs)(k.Layout,{children:[!Y&&Object(C.jsx)(D,{component:"biometricKycComponent/onBoardingAgreement",cameraAvailable:M,handleAction:()=>{q(!0)}}),V&&Object(C.jsx)(p.default,{state:S}),Object(C.jsxs)(U,{id:"faceApiContainer",children:[Object(C.jsx)(d.default,{data:null===J||void 0===J?void 0:J.solved}),Object(C.jsx)("h3",{className:"FRecTitle fuente",children:"Reconocimiento Facial"}),Object(C.jsxs)(N,{id:"videoContainer",children:[L&&Object(C.jsx)("div",{className:"biometricLoaderContainer"}),!V&&Object(C.jsx)(u.Scanner,{className:"FRecScanner"}),Object(C.jsx)("video",{id:"streamingVideo",autoPlay:!0,ref:B,width:"100%",height:"100%"})]}),Object(C.jsxs)(E,{children:[Object(C.jsx)(z,{className:"".concat(0===X?"active":"")}),Object(C.jsx)(z,{className:"".concat(1===X?"active":"")})]}),Object(C.jsx)("h1",{className:"fuente",children:null===J||void 0===J?void 0:J.uiName}),Object(C.jsx)("p",{className:"fuente",children:"Mant\xe9n tu cabeza erguida y asegurate que tu rostro encaje dentro del circulo"})]})]})};const z=l.b.div(j||(j=Object(a.a)(["\n  width:7px;\n  height:12px;\n  background:#c9c9c9;\n  border-radius:5px;\n  margin:0 4px;\n  transition:.3s;\n  &.active{\n    height:22px;\n    background:#0198ff;\n  }\n"]))),E=l.b.div(x||(x=Object(a.a)(["\n  height:30px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]))),N=l.b.div(y||(y=Object(a.a)(["\n  position: relative;\n  clip-path: circle(37% at 50% 50%);\n"]))),U=Object(l.b)(k.ContentContainer)(O||(O=Object(a.a)(["\n\n  .FRecTitle{\n    color:#0198ff;\n    font-weight:bold;\n  }\n  p{\n    text-align:center;\n    color:gray;\n    font-size: 1.2em;\n    max-width: 500px;\n    justify-self: center;\n  }\n  h1{\n    text-align:center;\n    font-size: 2.7em;\n    margin-bottom:0;\n  }\n  h3{\n    span{\n      color: transparent;\n      border-radius: 50%;\n      background: #2ad083;\n      margin-right: 10px;\n      font-size:15px;\n    }\n  }\n  @media (max-width: 768px) {\n  ","{\n    clip-path: circle(29% at 50% 50%);\n  }\n\n  padding: 30px 20px;\n  width:calc(100vw - 40px);\n\n  p{\n    font-size:1em;\n  }\n  h1{\n    font-size:2em;\n  }\n\n}\n"])),N)},477:function(n,e,t){"use strict";t.r(e),t.d(e,"getDisplaySize",(function(){return a})),t.d(e,"getFrame",(function(){return i}));const a=()=>{const n=document.querySelector("#streamingVideo");return{width:n.clientWidth,height:n.clientHeight}},i=()=>{const{width:n,height:e}=a(),t=document.querySelector("#faceApiCanvas");t.width=n,t.height=e;const i=document.querySelector("#streamingVideo");return t.getContext("2d").drawImage(i,0,0,n,e),t.toDataURL("image/jpeg")}},492:function(n,e,t){"use strict";t.r(e);var a,i,r=t(5),o=t(2),c=t(6),s=t(445),l=t(75),d=t(1);const u=Object(c.c)(a||(a=Object(r.a)(["\n    0% {\n        opacity: 1;\n        transform: scale(1);\n    }\n    30% {\n        transform: scale(0);\n        opacity: 0;\n    }\n    50%{\n        transform: scale(0);\n        opacity: 0;\n    }\n    80%{\n        opacity: 1;\n        transform: scale(1.3);\n    }\n    100%{\n        opacity: 1;\n        transform: scale(0.9);\n        background:#2ad083;\n        border: 4px solid white;\n    }\n    "]))),p=c.b.div(i||(i=Object(r.a)(["\n      width: 60px;\n      height: 60px;\n      position: absolute;\n      border-radius: 50%;\n      background: white;\n      border: 2px solid #cfcfcf;\n      top:175px;\n      right:200px;\n      z-index: 1;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      &.approve{\n         animation: "," .6s linear forwards;\n      }\n\n     \n\n    @media (max-width: 768px) {\n      top: 380px;\n      right: 0;\n      left: 50px;\n    }\n  "])),u);e.default=n=>{let{data:e}=n;const[t,a]=Object(o.useState)();return Object(o.useEffect)((()=>{e?a("approve"):setTimeout((()=>a()),400)}),[e]),Object(d.jsx)(p,{className:"".concat("approve"===t?"approve":"normal"),children:t?Object(d.jsx)(l.e,{size:37,color:"white"}):Object(d.jsx)(s.d,{size:30,color:"#a3a3a3"})})}},493:function(n,e,t){"use strict";t.r(e);var a,i=t(5),r=t(6),o=t(1);e.default=n=>{let{state:e}=n;return Object(o.jsx)(c,{id:"captures",children:Object.keys(e).map(((n,t)=>Object(o.jsx)("img",{src:e[n],width:"100%",alt:""},t)))})};const c=r.b.div(a||(a=Object(i.a)(["\n    position: absolute;\n    width: 150px;\n    height: auto;\n    min-height: 120px;\n    z-index: 2;\n    background: #ededed;\n    bottom: 10px;\n    right: 10px;\n    border-radius: 6px;\n    border: 3px solid darkgrey;\n"])))},495:function(n,e,t){"use strict";t.r(e),t.d(e,"Scanner",(function(){return s}));var a,i,r=t(5),o=t(6);const c=Object(o.c)(a||(a=Object(r.a)(["\n    0% {\n        top:0%\n    }\n    15%{\n        top:30%\n    }\n    35%{\n        top:70%\n    }\n    50%{\n        top:100%\n    }\n    65%{\n        top:70%\n    }\n    85%{\n        top:30%\n    }\n    100%{\n        top:0%;\n    }\n"]))),s=o.b.div(i||(i=Object(r.a)(["\n    height: 3px;\n    width: 100%;\n    position: absolute;\n    top: 0%;\n    transition: .3s;\n    filter: blur(0.1em);\n    background: rgb(255 255 255 / 10%);;\n    animation: "," 1.2s linear infinite;\n    &.scanning{\n    background: #2ad083;\n    }\n"])),c)},550:function(n,e,t){"use strict";var a=t(2),i=t(455),r=t(3);e.a=function(n,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const[o,c]=Object(a.useState)(),[s,l]=Object(a.useState)(t),[d,u]=Object(a.useState)(e[n[s]]),p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;s>=n.length||l((n=>n+e))},f=()=>{s<=0||l((n=>n-1))};return Object(a.useEffect)((()=>{var n;if(null===d||void 0===d||null===(n=d.settings)||void 0===n?void 0:n.queryParams){let n=Object(i.b)(d.settings.queryParams);null===r.fb||void 0===r.fb||r.fb.push(n)}}),[d]),Object(a.useEffect)((()=>{const t=e[n[s]];u(t)}),[s,e[n[s]]]),{currentStage:s,nextStage:p,prevStage:f,stageController:n,stageData:d,setStageData:u,stageStatus:o,setStageStatus:c,finalStage:s>=n.length}}},551:function(n,e,t){},606:function(n,e){},705:function(n,e,t){var a={"./biometricKycComponent/validations":[496,9,103],"./onBoardingComponent/validations":[514,7,27],"./personalKycComponent/validations":[488,9,21]};function i(n){if(!t.o(a,n))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+n+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=a[n],i=e[0];return t.e(e[2]).then((function(){return t.t(i,e[1])}))}i.keys=function(){return Object.keys(a)},i.id=705,n.exports=i}}]);
//# sourceMappingURL=8.8a74c81a.chunk.js.map